$versions = Get-ChildItem 'HKLM:\SOFTWARE\Adobe\After Effects' |
Select-Object -ExpandProperty Name |
ForEach-Object { $_ -replace 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Adobe\\' }




# Show Version
if ($versions.Count -eq 4) {
    $version = $versions[1]
}
else {
    for ($i = 0; $i -lt $versions.Count; $i++) {
        Write-Host ($i + 1)$($versions[$i])
    }

    while ($true) {
        $choice = Read-Host "Select After Effects Version"
        if (-not [int]::TryParse($choice, [ref]$null) -or $choice -lt 1 -or $choice -gt $versions.Count) {
            Write-Host "Please Select Correct Version(index)"
        }
        else {
            break
        }
    
    }
    
    $version = $versions[$choice - 1]
}
$version
