var panelGlobal = this;
var main = (function () {

    /*
    Code for Import https://scriptui.joonas.me — (Triple click to select): 
    {"activeId":20,"items":{"item-0":{"id":0,"type":"Dialog","parentId":false,"style":{"enabled":true,"varName":"main","windowType":"Palette","creationProps":{"su1PanelCoordinates":false,"maximizeButton":false,"minimizeButton":false,"independent":false,"closeButton":true,"borderless":false,"resizeable":false},"text":"Key  Assistant","preferredSize":[0,0],"margins":16,"orientation":"column","spacing":10,"alignChildren":["left","center"]}},"item-3":{"id":3,"type":"Image","parentId":8,"style":{"enabled":true,"varName":"catch_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACS0lEQVRIieWWTYhOURjH/6/NlGZYSZMFpcRM5CMki9mILCilxIyYhGQ1WShKKTWl2WiYbLBBPsdi8jmLaUqU2FjZTSYlJh8ZNSNeP536vzneeee991zLeerpnOe5z//+3nPuuc97NeOsVFkwkLL2+ZJ6JU1K6pL0Ka+wVCr9mwjgBH/IX7uWop1iCeKjRrYBOz3fnQqeVeBstXgclvTE82aPg2ENksYkrah3kyzwYkkjvtkF535E1395/CapR9ImSd2SypKGci1jmq35CnwEbntLDwNdnofrDZ6fA74D/c63O99a5BlvrBK/BN4CfRG45PmIx23OX3E8rwh4ucWdjg85HvVOVOrGnR+PcsEGPN8KLE091cEeed4ETDr3Iar54twNxxscXwReR69dd9ihvOD+aFuDX68BflG1zb2Oy8AE0AIcce5MXvA+C9Y6Xu34alSzAFgfxe+iVa50bp3jS3nBTRb05GwQayLo9ig/6tzmvODgb4D3OcGNwGNgf5Q7ZWhHass8YeGihLZa8WZrX2Wd6mXAmIuHgDnAQsd7CoDvWttaD7zF3eezX6GKDXi8kwhts+5sVgO55cJVLpoN3Ix+wHAieNC6xizwMRdervGcTgNLEqBzoyaiLHDwkxbcK/A8Y++oev8zwcGPWzT4H+D7VR0vFzj4QQufFgQT/UUmgYPv8g2eJUIr3auzKDiGp6z8fK3TnAqW21+wBznB5Xq7lAIOfoA0a88Cp3zQ75C0V9KEpJ/+AAz+O6ppkPRcUt90N5nyQT8zTNIfh/Zbfkki7F0AAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-4":{"id":4,"type":"Image","parentId":8,"style":{"enabled":true,"varName":"apply_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABz0lEQVRIie2WyyvFQRTHP9c7JNkoZUHyKI9sbC1kwcZKSbbIRkphY+NfsCO2ZOORndW1sWF7S1IWEqXIKxJHP82vpuk385vxWvnWNOfeOXc+c2buOTP866+U0TkiEpuzQJPnGt6BXWArzTGTySQPiEiRiKzI19QTLdzVrBKR+S9CIz2ISL4vuMBYRKtmbwBZ8zjMTQKmgXqgDKgAbtK2PAn8pNnrwKbHHH0KLL7QJLC+HzXGWDvQoXxivzegUfMZBR61XSoEjoGDNLBNa8BQik8EW7KMRUc2ApzHX+R5QNs8oGnqBuZ0Hx9w1zehsapCwS8/BH4OBTsynx1gDLgNXYUL/G70SYrObRnoBO6+A87X7Hiie8fva1V/pmr7oy/YTKdizV4AJoBydWm8GVUssnPa50uV53tAne8CPiUiA5Y67Cz+Rhu2zLHqingb6AcWVRlEldFBFbGpfeDa2LGZoGhVxHqrVG3ccSP1av4FInLi8HVGrCtOkSuHz4XqS4EjoME3SJ88LnOMRTncAhwCzb5QX7DrPp5U/+yWEKgvuCR0UouKQsE5Dx8fvVp9HLmZDXh7JelURNp0lu15a6oamFJ9qO7UAyFnfd7+69cEfACTHfD/B8fzSAAAAABJRU5ErkJggg=="],"alignment":null,"helpTip":null}},"item-5":{"id":5,"type":"Image","parentId":8,"style":{"enabled":true,"varName":"exp_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACbUlEQVRIieWWO2gWQRDHf58kwUdAwaCFBh9ISAxoJYKCGtAgChZaWAk+0E4Qi3QRtBACloqFhS+wUSsVBMFECx9gNFGU4AtRIhEtPjBYCOYvS+bCuN7ddxdNlT8su7c7M//duZ3ZYdqhEg4sqda5m4A9wGzgDFB1a8HGIWA+MBrpzQGGgUt+slKpjA8CcUark3RY0neN45ekRZFsk6RRZaM/tj2BDNIORxhwRVJnhuwGSSclDUT0PyS1lSE+6pS/SVqf45W47YvIdxQl3uWU7kpqKEGatCWSHjg7O4sQvzXhwUkQxm3QbI1ImplH3GOC7yXNyzDWl3GN+lJkGyU9t/WLntiH02Lgk+2lDRjKCK0+YCNwL5ofAI6kyC8H3tl4HfAwDqcu29npGu5LTlzG5d2mczZ29SxJj2xx8xQQt5pOCM/2wDnDuFcCa238JMPF/4Lw214CjUBLsFNnxpqtH4rSYR42pfz7PNwCwmmXeuKf1r8ucare6LtSQ/6Z9fWeOHH5xxLEHSVkMTcHjHnieutbShiq5doY7Z44PmknMLekwaJoNbmqJ+4H7th49RSQhvd8q43f4FwdcAPYAuwG7hcwFt/qqmWvNCT34fEfMhbkzS7vrimQQIrk6qTdNpmDabk64ATQDXwFVgEjKbvfm8RihA/AhZT5Y8Bxy9cryCl9/uez2OU8MlG9xK5OKwR6JS2YJKmvRM4VKQRCO+CUxiRtL0l6yun/5bk8YqLSJeCapP2SlmXIL5S0TdIrp3M5rXTKI+5RPtKqzadO40Xe80oUxx4h1q4CX6L5BksGwyk6N4HPwHngeobd6QrgN+O6QULG/18wAAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-6":{"id":6,"type":"Image","parentId":8,"style":{"enabled":true,"varName":"align_left_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAABFUlEQVRIie1VvWoCQRictcojpFBjZZ1CUEJSnIQ8g1W6vElIY0A4fA5JESFoglXeQEiZJi+QImIsMrKQg/G4k72fRYQbGFh25vtmvz2ORYWDw+gBSBY5zzWAcwChMWaT6OAukIEXUnmrPWslXGEA4P1//QdgmerMMUEg/jXJ9t5rzhjQE+8PyUaklRHQjTVvql404FI83yRP454iAVei/5I8S/LlDeiLtiHZSpsyT8BA9j9J1vd9I4Xrf9CR9TOAL8c65wlOSL6J9ug6gWtAxFfRQx8Bli/iufcRYDkV34OPAMsn8Q59BFguxD/yEWA5l5qxjwDLmdTdac8yHhyLGwATACsAHyrE32SmaVlgTO7SCkcHAFuU89DMTdtlkAAAAABJRU5ErkJggg=="],"alignment":null,"helpTip":null}},"item-7":{"id":7,"type":"Image","parentId":8,"style":{"enabled":true,"varName":"align_right_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAABFklEQVRIie1VMWpCQRSctQgewcJEK08gKEELU3iGVOlscwpJoyAEzyEpDEhiSJXeQkiZJhdIYVALRxZEh8837OqDgDgw8GHfzLy3/+9fnPHvcNoAyQsA9wAmAMaHNuecS18geccdrkkigluoZyaRMQWw2jx/AGiYbvGm2xLJuTTUCJwidYK0AM9LkjPRVK0DPK8SIRXrAM8cyR/R1qwDPAskF6KvWwd4FkkuxePGOsAzT/JLfG5DApLn4C98AxjKejlCGzRBV5p8I5m13KJH0Y+tX3JbtCPrz/RBdM/WB60jmifrX0VP6t8DzKMC+lL7GmgeHNCSupcI8+CD9gngF8AAQHNvJxFI3snHeG3Fbu+lfMbpAcAa9lDQzBrYuv4AAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-8":{"id":8,"type":"Group","parentId":0,"style":{"enabled":true,"varName":null,"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":9,"alignChildren":["right","center"],"alignment":null}},"item-9":{"id":9,"type":"Group","parentId":0,"style":{"enabled":true,"varName":null,"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":9,"alignChildren":["left","center"],"alignment":null}},"item-10":{"id":10,"type":"Image","parentId":9,"style":{"enabled":true,"varName":"move_right_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAAA3UlEQVRIie2VOwrCQBRFHxbiEiz8VS5ABEViobgIKzt34BLERkGQbEOwUBA/uBQbN2AhqCBHBgQfNjHhpdFcuEWac2aYmRdJ8ocB0sAA6AAS1NABerzTiENQAR5K0rIWuJaB6zeSqALXPHBRkrq1wLXwIalZC1yzwFlJPGuBaxG4KUnTWuBaAu5K0rYWuOaAo5J0g3ipkP6TiCzVd9V6BxO1+j2QsRTMFHxnfchDBV9bX9ORgq+sH9pYwRfWo2Kq4AfrYecr+NZ6XPcVfBPHD8d7TdB5EDySIMmPRUSe2d/lDPcxhrEAAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-11":{"id":11,"type":"Image","parentId":9,"style":{"enabled":true,"varName":"move_left_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAAA8klEQVRIie3UPYrCQBjG8cFCPMIWflV7gEVQJBaKh7Dazht4BLFREMRrCBYK4gcexcYLWAirIP9lRPFBdmWimULICw+EBJ7fzCTExBPPeQCX1IEWkAx9ag7lZW7zHTVQlfIT8BUloOU/wKe9HxVQkvI9kLk+iwIo3pVn9fmrQCDlO+DjfgGvABUpPwC5v47vWaAm5Ucg/9/LfwZoSPkGSD/6dHUSjkZBrifGmG34ZT7eQQpYyS56rjtwBa5ZCjLwAdjMBGn7AGymgnR8ADZjQbo+AJu1IH0fgM1CkKEPwGYuSNMHYDO6/FmD8FuI533HGPMLKGnlDFj0lv4AAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-12":{"id":12,"type":"Image","parentId":9,"style":{"enabled":true,"varName":"int_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACQElEQVRIieWWT4hNcRTHP08zkz+vKBMLJn/SNExhI0lppjSJshgLG2oQOxuL2Y2wUFOWZGEhlA1KoZTirZQyvCGSfws1GrF4ZbJQ5qvbnPs6/dzfdd9wV/Ot0/m9e885n/f7de+5hzmnSrJhSX/bdydwEFgIXAAa7l5S4xiwFJgK8hYBE8BVf7FSqcwsEnDE2iQdl/RdM/olaUUQ2ylpSnGNhbWbikD7HTDRdUkDkdgdks5Kqgf4H5LWtwI+4ZK/SdqecyqhHQrge4uC97mkh5I6WoCmtkrSY1dnsAj4vQWPzwIY2rjVmpQ0Pw88aoEfJS3JKNSX8xCdyoivSnph96/EwCtdkZ7IDjZLqpk1LLZuv4ciOWtd3W1Z4GG7eb7gMdYsvq9A7IjFXkzB84y9ABi09e0SuugN8weAXg/eAGy19dMSwG+AV0AV6PbgLhfQiOf/k+5Z8moP/mn+bUnQRM/Nt3tw6j+VCK6an/bAdvPdJYJ7s8DpTgeAxSWBe8w3PHgMeGDrTSVAk+/5Llu/8+BEd8zvLwHcb/4JUG9ete7S5VrblkgHarVXp3bfYo6mnSscfc4AI8BXYCMwGfzz5B0ciuyqZhbqJHAa+ACsI2f0+Z+fxWF3Is3pJTzqrEHgkaRls4T6SeRSkUEgsSMuaVrSnhah51z+HyeXByYYXRLdlHRY0ppI/HJJuyW9djnXskanPPCo8pU1bT5zGS8l7YydSKK2yBNat2/ol+B6hzWDiYycu8Bn4DJwK1J3rgr4DdGzOFN7P/WEAAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-13":{"id":13,"type":"Image","parentId":9,"style":{"enabled":true,"varName":"mir_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACZElEQVRIidWXX2iPYRTHP36zyQVhG0Lip1Hibi6shStXLhS3ZFG7WFOUlBt/UiM38qe28idck1xRyrQLxQ0jxhiRVjYbiotljk47L0+v3/v8nvf5tbRTb++f85w/33Oec87z8r9omojEmK4HbgL9wK4YBbGGVwCvEx0xCqbHCAEfgCbge6R8NOKKqRCpYBEwAjyIdUANbwEu55SrAuYC83PKqcMXgGZEpEcmqFdE6jT0k3Q1iMiw2epUxF/Mm7XAC2BBgOfVwBqgGIi0EXgK1Nr714KT5+dAHdAHrC6jaKkpehNgdCPwCJjhfPtVcEqqGTgMzAEeA+s8yjRK14HTZYxuBbpLckTktsV9ueX2lPylzRXku0WyqcMtpyS3B4Cj9nwH2F7C31nAIWBPBtL9wCVvLBzEjSmP2xx/d6d4DQ4vjfS4B2lCHb6WeR4YArqs9nQwnDDeINAODDvrNXoXg4eGB3Fy9Rq/r0xOqwKQ/kHsa5laqw+tvnWXr3d4iv4ecMX5Ng6sAj6HAM4yrIX+zEqqx+6jDl831yZgZ0rulTn6No/harsvs2ayErgFbAB+puTeW9daUkLnoBOlbHJyrM/1IvLD3q9V2LM15/dDctxm7XKmdaQdHn8XA2PAE8+acWuXN7JCPWbP54B5wDFgnzdME8cdTU1NmXVK24Cr/3wVkW4nBHsncSyedOycLdjuVWoBzgQgwAZL0UIeSgetFWsK3umZS8O20HZjKBWdkZj3lKmnliH1XHIaVfoG3AUGcsopfWIqnjJnA0eA1ljDsYi1q71MdMQoiP2T0HGpI/BjlDTwGzlavBdc2j61AAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-14":{"id":14,"type":"Image","parentId":9,"style":{"enabled":true,"varName":"copy_img","image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABeklEQVRIie2XPUvDQBiAnzSpYgelk6sgIuLi4OTuqOAgdRXxB/gX+hMcHZwUv36Ai3/AQUQUEUFwcBRBEdGifeXwrhxnml5jrl18IOQ+wj25JPe+OfpFpLwiYvRrwBjwpZpz3FMCvABHwH27i6Io+ikosYjUpThORaSix/11tBCRpQKlhs0scUnLJwO86umszkSfP6y2d2AdeOhSNArsW/UhH7H9Id0BO11KDW/AlP44D3zENiWnXgUWgBE9YBa3wJmeyCywqFeOOh6BQ6DZThxZZbW0LoDhnE/ApQ7UgHN3di6rBUoVE8AGKY/VZaBAqaHkI24EEDd8xMH4F/dVnCcdFi4u91I8DqwAMfAaSmxCZmy1DQJ7OrbehBKbGccpfZVQUlt8nNKnwuVnaPElMAOcANfAlU5x1VBiOy2q9Dfv9NdCiTsFkE6JP5g47UfhryQ+4mYAcdlHvFtwCH0CtlTB3cKkMQcs63Wd952rOPEMbKug1NrC9BzgG8KwB8m3Xw31AAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-15":{"id":15,"type":"Group","parentId":0,"style":{"enabled":true,"varName":null,"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-16":{"id":16,"type":"Image","parentId":15,"style":{"enabled":true,"varName":null,"image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACiklEQVRIieVWPWhUQRD+TmJADUQwGCEGTwW5IKgQLESIF5BDFCTGQhAMqGhnY2EZgoUQsLCxsjAq2KiFqCAIepVoEc2PSNAjhEAExSKSICKYT9bMymR8u28v2OWDuXn3dma+3Xmzs4sVh4JbMMm8dbcAOAVgLYDrAGbVmItxHsAGAPPGbx2AGQC39ctCobD44IgD0kDyAsk5LuIXyTZj20JynmEM29h/ESDtVoQOd0lWArZdJK+QHDH030l21EN8UTl/Jbk/khUrpw350VTi48rpOcnGOki9bCH5UsXptcRZxVUDsB3AGIDdkYIbED0FYChgMwpgF4DPAIoAfoSKa1BmOElyfWRFRbWaqYhdE8kxsbsVSvVmFayUk8oeRUqZSMh2m4q7zxOvUmk5Kdrt04lIih3Koqui90RsJwH0y3PfkhGSa0i+klkdTCieqtiWRV/LsS+JndueOzVxp0pH7Nt6oZDb55i8E9tjOtXtoidMO0xJs6vcAzk+Dk9EFzXxT9EfEgJ44hEzgXLA3uOt6NWa2OvpBGJfSANC2pNI3CR6wf006FkA2JFA7Alsc4lVtoMvqj/EdqUVAM0R56KMP5Su5+VbwopLomc18TCAZ4GVaNjvC/W/2RdOBtx5fkhef4RpII9En0ggrpr3eQXWLfr1kknL3mtXe3lvTuOwe9230KGA31MZPxc6Fi+LwReSm5ZxHGZJv8Ss5Z3HNTEc/Q+kl1QWK3nE+iLwguTGZZLqm8gNPRYidnJWOS2QPFIn6VXl/0/mYsQwVxeH+yTPkNwasG8leZjke+VzJ+vqFCMeZBxZt803ymM8drxCtUwLt9fuyV1Jo1GawUyGz2MAnwDcBPAgEHelAsBvNJuYbwEF/dUAAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-17":{"id":17,"type":"Image","parentId":15,"style":{"enabled":true,"varName":null,"image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAAA9UlEQVRIie2WPQrCQBCFX5JCREU8io2t9xAsLbyChZVHslAQCy08gAiCWFhobWfnkwWD62ZiJDsBhQxMMbvJfPOz7Cx+QkimaUDyzJdM3XhDzwQCAA3LrmkD+FTbVgVkSgkoHGCaei8S0HKOqTpgBiCy7EATsALQcdbmuTwJ18SaSRmbPQ3ARnA+ivd9AQvB+cQOIC+gTfIkOO+55XPl2ybXATSF9Wu+kJMZGI1IboUshholirVK8ihA+loAoxWS+7RMNABGQ5I7ATLQAsTlOjiApfuvz1VxA9DN+sj3srtkHVWNV8VHH+VM/n+AabI9Jt9HJoAHNLOG8rQFjbwAAAAASUVORK5CYII="],"alignment":null,"helpTip":null}},"item-18":{"id":18,"type":"Image","parentId":15,"style":{"enabled":true,"varName":null,"image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABBUlEQVRIie3WP2sCMRjH8cfadvDf4NQ34dzN2bfgK3ITujm62dlbCtLJsUMLhW6C4ORUqNTNfuVoSiE+5S7mEivcDx4ecpB8yB0JJ3kDDPjOh+kjQP6qrFzklkXqpjdNrznMPYgLvLPGX7HgQlPCZwFnn5lA8E0s+Moa90Rk6IPnCtAFNhxGvcGKhNNqAysFvw8Np3UNvCl4Ehr+qScFn8WA0xor+Bq4zVrP9wJ5V561RKThue5vlN0mym5fgUrIV/2goM/AZahvXAVeFPQx5HHqAEsFnYa+QO4UdBLjn8tebS4ifecdFAAvjkVdYTuVU8FeKeF/CVc95nrBn6ZvTN8erYrIHlHT0lgL9zT+AAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-19":{"id":19,"type":"Image","parentId":15,"style":{"enabled":true,"varName":null,"image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQdJREFUeNrslv0NgyAQxcV0AEZwBEdoN3AEu0E7iSN0hW6gG9gRuoFuQB8NtGg9QSL4R33JixcUf3zcEZiAkg2UJhvpYMRX+BGYl8PVOxJfHV164rsc5j5UydCwdEGnAu4QtnCH+OY7AOcZ410moeJXVegZFzAn2jfJah4afF/Yvg6YMfbE4wz3RnOjSjBcchnfcpUgWbRyUjPv4UatgDmYWtZ3tORSdVzDcrUWwVPLjyu4tEBzI8Pd4dQeq5NJq5zY61ZMq6Pg5h5PgkfQAdwCnYXPggmo1sUBSsJJsAXqowGcArcijD5wE8wiXX3kiXfSmR/z6jMuvYT93WVvB+/gHbyaXgIMAHWCmD3KjfSwAAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}},"item-20":{"id":20,"type":"Image","parentId":15,"style":{"enabled":true,"varName":null,"image":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQdJREFUeNrslv0NgyAQxcV0AEZwBEdoN3AEu0E7iSN0hW6gG9gRuoFuQB8NtGg9QSL4R33JixcUf3zcEZiAkg2UJhvpYMRX+BGYl8PVOxJfHV164rsc5j5UydCwdEGnAu4QtnCH+OY7AOcZ410moeJXVegZFzAn2jfJah4afF/Yvg6YMfbE4wz3RnOjSjBcchnfcpUgWbRyUjPv4UatgDmYWtZ3tORSdVzDcrUWwVPLjyu4tEBzI8Pd4dQeq5NJq5zY61ZMq6Pg5h5PgkfQAdwCnYXPggmo1sUBSsJJsAXqowGcArcijD5wE8wiXX3kiXfSmR/z6jMuvYT93WVvB+/gHbyaXgIMAHWCmD3KjfSwAAAAAElFTkSuQmCC"],"alignment":null,"helpTip":null}}},"order":[0,8,3,4,5,6,7,9,14,13,12,11,10,15,19,20,16,17,18],"settings":{"importJSON":true,"indentSize":false,"cepExport":false,"includeCSSJS":true,"showDialog":true,"functionWrapper":true,"afterEffectsDockable":true,"itemReferenceList":"None"}}
    */

    // MAIN
    // ====
    var main = (panelGlobal instanceof Panel) ? panelGlobal : new Window("palette");
    if (!(panelGlobal instanceof Panel)) main.text = "Key  Assistant";
    main.orientation = "column";
    main.alignChildren = ["left", "center"];
    main.spacing = 10;
    main.margins = 16;

    // GROUP1
    // ======
    var group1 = main.add("group", undefined, { name: "group1" });
    group1.orientation = "row";
    group1.alignChildren = ["right", "center"];
    group1.spacing = 9;
    group1.margins = 0;

    var catch_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%02%C2%9DIDATH%C2%89%C2%BD%C2%97_h%C3%8EQ%18%C3%87%3F%7B%C3%8D%C3%B2%C2%B7%C2%A6Q%C2%B35%C2%8D%25%09%C2%8D%0B3Eq%C2%81%C2%B4%C3%A5fC%C2%B9P%C2%B4%C2%8B%C2%B1%0B%24%C2%A9a%C3%9C%C3%91%C3%8AP%C2%96%C2%92%5C%C2%B8%C2%98f%25%C2%B9%C3%A1FQ%C2%94%14--%C2%BB%60%2B%C3%8D%C2%AC%C3%9D%18f%C2%8D%C3%82W%C2%A7%C2%9E%C2%B7N%C2%BF~%C3%AF%C3%BB%3B%C3%AF%C2%BB%C3%8DSO%C2%A7%C3%A7%3C%C3%9F%C3%A7%C3%B9%C3%BE%C2%9E%C3%93%C3%AF%C2%9C%C3%A7%C2%9C%02I%04%C3%8A%16%60%2B%C2%B0%1A%C2%A8%04%C3%96%01%C2%85%C3%80%5B%60%08x%07%C2%BC%00%C2%9E%04%C2%A5s%C3%84%09%C3%9A%2C%C3%A9%C2%B5%C3%82%C2%A5O%C3%92IIs%C2%B2%C3%A5%C3%8DV%C3%B1v%C3%A0%06%C2%B0%C3%8A%C2%9B%7B%04%C3%B4%01%C3%8F%C2%81%11%C3%B7%C3%9D%C3%80%12%C2%A0%16X%0F%C3%AC%00%C3%A6%1A%C3%96%C3%B9%C2%8F%02%0Fr%C2%A9%C3%B8%C2%8CW%C3%9F%C2%98%C2%A4VI%C2%A5%01%C2%ABS%2C%C3%A9%C2%84%C2%A4!%2F%C3%BEr%1C6.%C3%B8%C2%AA%17%C3%94%25%C2%A9%24%C2%800%C2%AAn%C2%99%3B%C2%BD%3C%3DI%C3%84%C2%A7%3D%C3%B0%C3%B9%3C%08%C2%A3%C3%9A%C3%A2%C3%A5%C2%BB%C2%92%C2%89%C2%B8%C3%86%03%C2%9DMH8_%C3%92%25%C3%93%C2%B2%04l%C2%93%C2%97wO%1C%C3%B1gs%C3%9E%0F%C2%A8%C2%A4%C3%94KV%1B%C2%80%C2%BFn%C3%98_%C2%92%C3%A6%C3%B9%C3%84%C2%87%C3%8D1.%C2%A9(%20%C3%91b%C2%8F%C2%B8%3Ap%C3%99%C2%87%0D%C3%9F%C3%A6%13%0F%C3%9Adk%60%C2%92%7C%C2%88%0F%18~2M%C2%BC%C3%89%26~JZ0%C2%83%C3%84N%C2%BFZL%5D%0A%C2%A8%C2%B3-%C3%BD%0C%C3%B8%11z~%C3%A6)w-l%C2%AF%23%5En%C3%86%C2%AB%19%26u%C3%B2%C3%86%C3%86%C2%95%C2%8E%C2%B8%C3%8A%C2%8C%C2%97%C3%BF%C2%81%C3%B8%C2%A3%C2%8D%C3%A5%C2%8Ex%C2%8D%19%C2%9F%C3%B2L%C3%B6%25%07%C3%AC%C2%A0%C2%8De%C2%8ExV%1Ed~LU%16%5CT%C3%BE%C2%9A%C2%9DJY%1F%C3%85%C2%BAL%C2%A8L%02%13%C2%86%7D%08%C3%AC%0B%C2%8C%C2%AB%C2%B4q%24%C3%A5%C2%95_%C2%93%03%C3%B1w%60%23%C3%90%0B%2C%04%C2%BA%C2%81S%01q%C3%8Bl%1Cv%C3%84%03fl%C3%8E%C2%81%C3%98I%3F%C2%B0%01%C2%B8cv%3B%C3%90c%1F%C2%92I%C2%AAm~%C3%80m%C3%AAm%C2%B6%C2%A9'%02%C2%8F%C3%8B8%3D%C3%A6%1D(%C3%BD%C2%92fg%C3%80%C2%8D%1A%C2%A61%C3%9A%20Z%C2%A6%C3%90%02wK%1A%C2%91tQR*%C3%86_%C3%AF%7D%5CAz%C3%B2%C2%B8M%C2%8CN%C2%81%18k%C2%97%C2%99%7C%C3%AF%C2%8D%C2%A3C%C2%91%C2%B68n%C2%8E%5BS%24%C2%8F%C3%93%0B%5E%C2%B5%C3%85Q%C3%A2%5D%C2%9E%C3%B3%C3%884%C2%926zy%0F%C2%A5%C3%A7%C2%A3%C2%A0%0E%0F%C3%944%0D%C2%A4%0D%5E%C2%BE.%C3%9F%17%07%C3%AE%C3%B6%C3%80%C3%97%C3%9C%C2%8F%C2%90'i%C2%9B%C2%97%C3%A7i%C3%94%C2%9F)%C3%88%C2%AF%C3%BC%C2%83%C2%A4%C2%83%C3%A9%2BK%C2%82%16%C3%9A%C3%92%C3%B6z%C3%B1%C2%B7%C3%A3b%C2%B2%5D%C3%A8%C3%B7%03%C2%9D%40%C2%89%C3%99c%C3%80%3D%C2%BB%C3%90%0F%C3%98%C2%89%C3%B7%07Xa%C2%ADu-%C3%90%00%2C5%C3%BCo%C2%A0%05%C2%B8%19%C2%9B%3D%C2%A1%C2%82E%C2%92%C3%8Ey%1B%3FD%C2%BEIj%C2%97T%C2%91-w%C3%A8%C2%A3%C2%AD%08%C3%98%09%C3%94%C3%9B%C2%A3%C2%AD%1C%C2%A8p%5D%C3%86%1El%C2%A3%C3%96l%C3%9C%13%C3%A7q%C3%A2M%06%C3%B8%07u%19%11%C3%BC.%13!%07%00%00%00%00IEND%C2%AEB%60%C2%82";
    var catch_img = group1.add("image", undefined, File.decode(catch_img_imgString), { name: "catch_img" });

    var apply_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%03%C2%B1IDATH%C2%89%C3%85%C2%96Oh%1Cu%14%C3%87%3F%C2%BF%C3%B9%C2%B3%C2%9B%C2%ACi%C2%92M%C2%9Ah%1B)%C2%B1%C3%B5_i%20%C2%95Z%C2%B5%C2%8AX%C2%A4X%C2%B0P%C3%B0%22%C2%A2B%0D6%C2%A0%22%22%3D%14%3D%C3%B4%C2%A0%08%C3%A2EQ%C3%84%C2%9BEz%C3%A8E%C2%BC%18%2F*%C2%A2%C2%82B%C3%89%C2%A1%C2%A1F%C3%9B%C2%B4%C2%A5%C2%B4MZI%C3%9664%24%C3%8D%C3%AE%C3%AC%C3%8E%C3%8C%C2%93%C3%9F2%C2%B3n%263%C2%BB%C2%B3%C2%A9%C3%A8%17%C3%A62%C2%BF%C3%B7%C3%9E%C3%B7%C2%BD%C3%9F%7B%C2%BF%C3%B7%1E%C3%BF%17%C2%94%C3%A6%15%C2%91V%C3%A8%1F%066%03%C2%BD%C2%81%C3%BE%3Cp%09%18%07*i%0C(%C2%A5%C2%B0Z%20%7C%08%C3%98%0F%C3%AC%01%06%C2%81.%C3%80%00%16%C2%80i%C3%A0g%60%0C%C3%B8)%C2%B5E%1Dq%C2%83%C3%AFi%11%C3%B9U%C3%92%C3%A3%C2%94%C2%88%C2%BC%C3%98%C3%88f%1A%C3%A2%C3%8FZ%20%C2%8C%C3%A2k%11%C3%89%C2%AE%C2%85x%C3%A2%16HC%5C%11%C2%91%C3%BE8%C3%A2%C2%A4%C3%A2%C2%9A%00%C2%B6%C2%B7%C2%90%C3%BFF%C3%B8%13%C2%B8%1B(%C2%862I%C3%85%C3%B5y%02%C2%A9%C3%AB%5E%5B%C3%92%1E%1A%C3%8AP5O%C3%85%17%C2%85%C3%82%C2%B7z%3Bt%C2%A1%C2%991z%1B%C2%81%1F%C2%81G%C3%AA%7FF%23%C3%9E%1D%08%C3%95Cn%7Cy%C3%92%C2%B94r%C3%94%C3%B4n.%7BZE%C2%A1T%C2%8D%18%C2%AD%C3%AC%C2%ABL%7F%C2%8F1x%C3%AC%C2%A0%C2%B7n%C3%AF%C3%96%C2%B6%C2%84%C3%A8_%00%C2%8E%C2%87%11G%C2%89O%03%5B%C3%AB%C2%A5%17%C3%86~%2B%C2%9D%C3%9E%7F%24%C3%93%C2%BFo%C2%8F%C3%9B%C3%BB%C3%92%C2%A3%0A%C3%93%C2%A89%1C%C2%B8.%C3%A2x%C2%AA%C3%B0%C3%A1%C3%B7%C3%BE%C3%BC%C3%B8%09kx%C3%BC%C3%A3Jn%C3%A7%606%C2%86%C3%B8%1A%C3%90%17%12%C3%83%3F%C3%855%14S%1C%C3%AE%C2%A9%C2%BEC%C2%95%C2%B3%C2%8F%C2%BF_%11%C2%91J%C2%93Br%C3%BE%18%3E%C3%A2%C2%9C%19~%C2%A7%C2%AC%C3%B5%12d%C2%9E%0D%C2%834%02otnF%C2%A2.%C2%8A%C3%AB%C3%A3%C3%BE%C2%B5H%C3%8F%C3%B3%C2%BB%1Ch%C3%9Al2%C3%AB%0F%3C!%C2%A5%C3%B3%05%C2%A3%C3%8En%14%2F%07%C3%8D%C2%A7%26%C3%B0%20%C3%B0%C3%A4*1%C3%8F%13%23k%C2%89%C3%8AX*%C3%81%C3%90JG%C2%97K%18%C2%B7e%C3%8D%15%C2%A9X%C2%89%1D%C3%80%C2%AEz%C3%A2%7B%C2%81M%C2%AB%C3%84t.%C2%94B%C3%8An%1A%5E%C3%BCb%05%C3%BF%C2%A6%C3%93H%C2%A47%C3%A8%C3%B35%C3%A2%1E%C2%A03%C2%95%C3%B5%06%C2%B0%C3%AF%C3%8Ccv%C3%A7%C2%8A%C3%95bOF%C2%95'%C3%8C%C2%9Bjp%3Di%20%C3%8E%C3%B9Be%C3%9DS%C3%9B%24%C3%BF%C3%9C%C3%8ET%0Aa%C3%847%C2%80%C3%85U%C2%A7%C3%95'*%18mv%C2%B3%C2%B9)g%1F%C3%BB%40f%C3%9F%C3%BD%C3%862%C2%BBs%C3%ADM%C2%82X%C2%AA'%C2%BE%00%5C%C2%8DJ(%C3%9BR~%C2%B9b%C2%B8%C3%97%C2%8B%C2%8D%0Cyz%0E%1BY%C3%9B%0C%1A%C2%82%C2%9E%C3%89~%C2%82%C3%ACB0%C2%BBk%0D%24%03%7C%04%C2%BC%165%3A%C2%B5%C3%A3%3D)%C3%8D%C3%8C%1A%C3%9B%0B%C2%9F%C2%96%C3%B5%C2%93%C2%A9%7F*%C3%85%C3%89%C2%AB%C3%9E%C2%85%7D%C2%9F%C2%B8fg%C2%BB%C3%A1%C2%97*%C2%B62%0D%11%C3%8Fs%C2%AD%C3%9B%C2%BB%C3%BC%7B%C2%BE%7D%C3%934%3A%C2%B2%C3%91'%C3%B8%0B0%C2%AA%C2%94%C2%9A%0A%0F%C2%B4%C3%91c1%C3%84%C3%A6%5D%C3%87G%C2%9D%C3%89%C3%BB%0F%7B%13%C3%B6%2B%C3%B4%C2%BD%C2%BA%C3%9B7r%19%C3%83%2F%C2%96%C2%B1%C3%BA%3B%C2%A5%C3%BB%C2%99%07%7C%7B%20%C2%AF%C2%AC%7C%C2%8E%C3%92%C2%B99Qm%C2%B6%C3%98%7Dy%C3%8C%C2%8E%C2%A4%C2%AEY%C3%A5%C2%98%22%C2%A6W_%01%06%C2%A2%C3%92%C3%AE%C3%ACR%C3%B1%C3%B2%C3%A8%17%C3%A6%C3%B2%C3%89iU%7D%C3%9D%0BE%C3%9A%C2%876r%C3%9F%C2%89%C2%B73%C2%81%0Dwr%C3%A0%C2%B0%C3%91%C2%B5w%C2%9Bl%3Az%40%25%0C%0B%C3%BD%C3%8Er%3A%0Dq%C3%93%C3%A9%0D%C3%A0%C2%AB%C2%A8%C2%86uGG%C3%BB%C2%96%C2%B1%C3%97%25%C3%88g%C2%A8S%C3%9F%C2%A1%C3%B4%C3%84*%C3%BBe%C3%97%08%C3%92%11%C2%87%C2%B7V%C3%A5%3E2%C2%A8%C2%BF%5B%C3%8B%C3%84w%C2%A6%C2%AF%17%2B%C2%85E'%C3%A1%C3%B8b%C2%9AE%40_%C3%93%2C%C2%B0%3E)Q-B%1B%C3%9F%00%C3%8C%C2%85j%C3%BA%C2%AA%C3%A3%C2%9A%C2%B9%C2%BE%C3%8E!%60%C3%A6_%20%5D%0E%C3%96%C3%A1%C2%B9%C3%98%C3%93%C2%84%C2%9D%2B'%22%3F%C2%AC%C3%A5%C3%9A%03%C2%9C%11%C2%91%0Dk%C3%9D2%C3%B57%12%C3%A4(-%C3%A6E%C3%A4%C3%90%C2%AD%C2%AE%C2%B7%C3%B5%C2%9F%C3%9E%C2%95%C3%87Dd%26%C3%86%C2%81%C3%99%C3%A0v%0E%C2%8A%C2%88%C3%9D%C3%8CV5%C3%8F!qJ%C3%A8mQ%2F%C2%82%5B%C2%82)%C2%A3%C3%B5u%C2%8F%C2%BF%08%C3%BC%1E%7CMQ%5B%7D%C3%BEs%00%7F%03V%C3%AB%13Z%C3%86%1E0%C3%B6%00%00%00%00IEND%C2%AEB%60%C2%82";
    var apply_img = group1.add("image", undefined, File.decode(apply_img_imgString), { name: "apply_img" });




    var exp_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%02mIDATH%C2%89%C3%A5%C2%96%3Bh%16A%10%C3%87%7F%C2%9F%24%C3%81G%40%C3%81%C2%A0%C2%85%06%1FHH%0Ch%25%C2%82%C2%82%1A%C3%90%20%0A%16ZX%09%3E%C3%90N%10%C2%8Bt%11%C2%B4%10%02%C2%96%C2%8A%C2%85%C2%85%2F%C2%B0Q%2B%15%04%C3%81D%0B%1F%604Q%C2%94%C3%A0%0BQ%22%11-%3E0X%08%C3%A6%2FK%C3%A6%C3%82%C2%B8%C3%9E%C3%9Dw%17M%C2%95%3F%2C%C2%BB%C2%B7%3B3%C3%BF%C3%9D%C2%B9%C2%9D%C3%99a%C3%9A%C2%A1%12%0E%2C%C2%A9%C3%96%C2%B9%C2%9B%C2%80%3D%C3%80l%C3%A0%0CPuk%C3%81%C3%86!%60%3E0%1A%C3%A9%C3%8D%01%C2%86%C2%81K~%C2%B2R%C2%A9%C2%8C%0F%02qF%C2%AB%C2%93tX%C3%92w%C2%8D%C3%A3%C2%97%C2%A4E%C2%91l%C2%93%C2%A4Qe%C2%A3%3F%C2%B6%3D%C2%81%0C%C3%92%0EG%18pERg%C2%86%C3%AC%06I'%25%0DD%C3%B4%3F%24%C2%B5%C2%95!%3E%C3%AA%C2%94%C2%BFIZ%C2%9F%C3%A3%C2%95%C2%B8%C3%AD%C2%8B%C3%88w%14%25%C3%9E%C3%A5%C2%94%C3%AEJj(A%C2%9A%C2%B4%25%C2%92%1E8%3B%3B%C2%8B%10%C2%BF5%C3%A1%C3%81I%10%C3%86m%C3%90l%C2%8DH%C2%9A%C2%99G%C3%9Cc%C2%82%C3%AF%25%C3%8D%C3%8B0%C3%96%C2%97q%C2%8D%C3%BARd%1B%25%3D%C2%B7%C3%B5%C2%8B%C2%9E%C3%98%C2%87%C3%93b%C3%A0%C2%93%C3%AD%C2%A5%0D%18%C3%8A%08%C2%AD%3E%60%23p%2F%C2%9A%1F%00%C2%8E%C2%A4%C3%88%2F%07%C3%9E%C3%99x%1D%C3%B00%0E%C2%A7.%C3%9B%C3%99%C3%A9%1A%C3%AEKN%5C%C3%86%C3%A5%C3%9D%C2%A6s6v%C3%B5%2CI%C2%8Flq%C3%B3%14%10%C2%B7%C2%9AN%08%C3%8F%C3%B6%C3%809%C3%83%C2%B8W%02km%C3%BC%24%C3%83%C3%85%C3%BF%C2%82%C3%B0%C3%9B%5E%02%C2%8D%40K%C2%B0Sg%C3%86%C2%9A%C2%AD%1F%C2%8A%C3%92a%1E6%C2%A5%C3%BC%C3%BB%3C%C3%9C%02%C3%82i%C2%97z%C3%A2%C2%9F%C3%96%C2%BF.q%C2%AA%C3%9E%C3%A8%C2%BBRC%C3%BE%C2%99%C3%B5%C3%B5%C2%9E8q%C3%B9%C3%87%12%C3%84%1D%25d17%07%C2%8Cy%C3%A2z%C3%AB%5BJ%18%C2%AA%C3%A5%C3%9A%18%C3%AD%C2%9E8%3Ei'0%C2%B7%C2%A4%C3%81%C2%A2h5%C2%B9%C2%AA'%C3%AE%07%C3%AE%C3%98x%C3%B5%14%C2%90%C2%86%C3%B7%7C%C2%AB%C2%8D%C3%9F%C3%A0%5C%1Dp%03%C3%98%02%C3%AC%06%C3%AE%170%16%C3%9F%C3%AA%C2%AAe%C2%AF4%24%C3%B7%C3%A1%C3%B1%1F2%16%C3%A4%C3%8D.%C3%AF%C2%AE)%C2%90%40%C2%8A%C3%A4%C3%AA%C2%A4%C3%9D6%C2%99%C2%83i%C2%B9%3A%C3%A0%04%C3%90%0D%7C%05V%01%23)%C2%BB%C3%9F%C2%9B%C3%84b%C2%84%0F%C3%80%C2%85%C2%94%C3%B9c%C3%80q%C3%8B%C3%97%2B%C3%88)%7D%C3%BE%C3%A7%C2%B3%C3%98%C3%A5%3C2Q%C2%BD%C3%84%C2%AEN%2B%04z%25-%C2%98%24%C2%A9%C2%AFD%C3%8E%15)%04B%3B%C3%A0%C2%94%C3%86%24m%2FIz%C3%8A%C3%A9%C3%BF%C3%A5%C2%B9%3Cb%C2%A2%C3%92%25%C3%A0%C2%9A%C2%A4%C3%BD%C2%92%C2%96e%C3%88%2F%C2%94%C2%B4M%C3%92%2B%C2%A7s9%C2%ADt%C3%8A%23%C3%AEQ%3E%C3%92%C2%AA%C3%8D%C2%A7N%C3%A3E%C3%9E%C3%B3J%14%C3%87%1E!%C3%96%C2%AE%02_%C2%A2%C3%B9%06K%06%C3%83)%3A7%C2%81%C3%8F%C3%80y%C3%A0z%C2%86%C3%9D%C3%A9%0A%C3%A07%C3%A3%C2%BAAB%C3%86%C3%BF_0%00%00%00%00IEND%C2%AEB%60%C2%82";
    var exp_img = group1.add("image", undefined, File.decode(exp_img_imgString), { name: "exp_img" });

    var align_left_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%18%00%00%00%1E%08%06%00%00%006.%C3%9E%C3%A5%00%00%01%15IDATH%C2%89%C3%ADU%C2%BDj%02A%18%C2%9C%C2%B5%C3%8A%23%C2%A4Pce%C2%9DBPBR%C2%9C%C2%84%3C%C2%83U%C2%BA%C2%BCIHc%408%7C%0EI%11!h%C2%82U%C3%9E%40H%C2%99%26%2F%C2%90%22b%2C2%C2%B2%C2%90%C2%83%C3%B1%C2%B8%C2%93%C2%BD%C2%9FE%C2%84%1B%18Xv%C3%A6%C3%BBf%C2%BF%3D%C2%8EE%C2%85%C2%83%C3%83%C3%A8%01H%169%C3%8F5%C2%80s%00%C2%A11f%C2%93%C3%A8%C3%A0.%C2%90%C2%81%17Ry%C2%AB%3Dk%25%5Ca%00%C3%A0%C3%BD%7F%C3%BD%07%60%C2%99%C3%AA%C3%8C1A%20%C3%BE5%C3%89%C3%B6%C3%9Ek%C3%8E%18%C3%90%13%C3%AF%0F%C3%89F%C2%A4%C2%95%11%C3%90%C2%8D5o%C2%AA%5E4%C3%A0R%3C%C3%9F%24O%C3%A3%C2%9E%22%01W%C2%A2%C3%BF%C2%92%3CK%C3%B2%C3%A5%0D%C3%A8%C2%8B%C2%B6!%C3%99J%C2%9B2O%C3%80%40%C3%B6%3FI%C3%96%C3%B7%7D%23%C2%85%C3%AB%7F%C3%90%C2%91%C3%B53%C2%80%2F%C3%87%3A%C3%A7%09NH%C2%BE%C2%89%C3%B6%C3%A8%3A%C2%81k%40%C3%84W%C3%91C%1F%01%C2%96%2F%C3%A2%C2%B9%C3%B7%11%609%15%C3%9F%C2%83%C2%8F%00%C3%8B'%C3%B1%0E%7D%04X.%C3%84%3F%C3%B2%11%609%C2%97%C2%9A%C2%B1%C2%8F%00%C3%8B%C2%99%C3%94%C3%9Di%C3%8F2%1E%1C%C2%8B%1B%00%13%00%2B%00%1F*%C3%84%C3%9Fd%C2%A6iY%60L%C3%AE%C3%92%0AG%07%00%5B%C2%94%C3%B3%C3%90%C3%8CM%C3%9Be%C2%90%00%00%00%00IEND%C2%AEB%60%C2%82";
    var align_left_img = group1.add("image", undefined, File.decode(align_left_img_imgString), { name: "align_left_img" });

    var align_right_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%18%00%00%00%1E%08%06%00%00%006.%C3%9E%C3%A5%00%00%01%16IDATH%C2%89%C3%ADU1jBA%14%C2%9C%C2%B5%08%1E%C3%81%C3%82D%2BO%20(A%0BSx%C2%86T%C3%A9ls%0AI%C2%A3%20%04%C3%8F!)%0CHbH%C2%95%C3%9EBH%C2%99%26%17HaP%0BG%16D%C2%87%C3%8F7%C3%AC%C3%AA%C2%83%C2%8080%C3%B0a%C3%9F%C3%8C%C2%BC%C2%B7%C3%BF%C3%AF_%C2%9C%C3%B1%C3%AFp%C3%9A%00%C3%89%0B%00%C3%B7%00%26%00%C3%86%C2%876%C3%A7%C2%9CK_%20y%C3%87%1D%C2%AEI%22%C2%82%5B%C2%A8g%26%C2%911%05%C2%B0%C3%9A%3C%7F%00h%C2%98n%C3%B1%C2%A6%C3%9B%12%C3%89%C2%B94%C3%94%08%C2%9C%22u%C2%82%C2%B4%00%C3%8FK%C2%923%C3%91T%C2%AD%03%3C%C2%AF%12!%15%C3%AB%00%C3%8F%1C%C3%89%1F%C3%91%C3%96%C2%AC%03%3C%0B%24%17%C2%A2%C2%AF%5B%07x%16I.%C3%85%C3%A3%C3%86%3A%C3%803O%C3%B2K%7CnC%02%C2%92%C3%A7%C3%A0%2F%7C%03%18%C3%8Az9B%1B4AW%C2%9A%7C%23%C2%99%C2%B5%C3%9C%C2%A2G%C3%91%C2%8F%C2%AD_r%5B%C2%B4%23%C3%AB%C3%8F%C3%B4At%C3%8F%C3%96%07%C2%AD%23%C2%9A'%C3%AB_EO%C3%AA%C3%9F%03%C3%8C%C2%A3%02%C3%BAR%C3%BB%1Ah%1E%1C%C3%90%C2%92%C2%BA%C2%97%08%C3%B3%C3%A0%C2%83%C3%B6%09%C3%A0%17%C3%80%00%40so'%11H%C3%9E%C3%89%C3%87xm%C3%85n%C3%AF%C2%A5%7C%C3%86%C3%A9%01%C3%80%1A%C3%B6P%C3%90%C3%8C%1A%C3%98%C2%BA%C3%BE%00%00%00%00IEND%C2%AEB%60%C2%82";
    var align_right_img = group1.add("image", undefined, File.decode(align_right_img_imgString), { name: "align_right_img" });

    catch_img.addEventListener("click", get_time_list, false)
    apply_img.addEventListener("click", creat_key, false)
    exp_img.addEventListener("click", exp_to_key, false)
    align_left_img.addEventListener("click", move_to_left, false)
    align_right_img.addEventListener("click", move_to_right, false)
    // GROUP2
    // ======
    var group2 = main.add("group", undefined, { name: "group2" });
    group2.orientation = "row";
    group2.alignChildren = ["left", "center"];
    group2.spacing = 9;
    group2.margins = 0;

    var copy_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%01zIDATH%C2%89%C3%AD%C2%97%3DK%C3%83%40%18%C2%80%C2%9F4%C2%A9b%07%C2%A5%C2%93%C2%AB%20%22%C3%A2%C3%A2%C3%A0%C3%A4%C3%AE%C2%A8%C3%A0%20u%15%C3%B1%07%C3%B8%17%C3%BA%13%1C%1D%C2%9C%14%C2%BF~%C2%80%C2%8B%7F%C3%80AD%14%11App%14A%11%C3%91%C2%A2%7D%C3%A5%C3%B0%C2%AE%1Cg%C2%9A%5Ec%C2%AE%5D%7C%20%C3%A4%3E%C3%82%3D%C2%B9%24%C3%B7%C2%BE9%C3%BAE%C2%A4%C2%BC%22b%C3%B4k%C3%80%18%C3%B0%C2%A5%C2%9As%C3%9CS%02%C2%BC%00G%C3%80%7D%C2%BB%C2%8B%C2%A2(%C3%BA)(%C2%B1%C2%88%C3%94%C2%A58NE%C2%A4%C2%A2%C3%87%C3%BDu%C2%B4%10%C2%91%C2%A5%02%C2%A5%C2%86%C3%8D%2CqI%C3%8B'%03%C2%BC%C3%AA%C3%A9%C2%AC%C3%8ED%C2%9F%3F%C2%AC%C2%B6w%60%1Dx%C3%A8R4%0A%C3%AC%5B%C3%B5!%1F%C2%B1%C3%BD!%C3%9D%01%3B%5DJ%0Do%C3%80%C2%94%C3%BE8%0F%7C%C3%846%25%C2%A7%5E%05%16%C2%80%11%3D%60%16%C2%B7%C3%80%C2%99%C2%9E%C3%88%2C%C2%B0%C2%A8W%C2%8E%3A%1E%C2%81C%C2%A0%C3%99N%1CYe%C2%B5%C2%B4.%C2%80%C3%A1%C2%9CO%C3%80%C2%A5%0E%C3%94%C2%80swv.%C2%AB%05J%15%13%C3%80%06)%C2%8F%C3%95e%C2%A0%40%C2%A9%C2%A1%C3%A4%23n%04%107%7C%C3%84%C3%81%C3%B8%17%C3%B7U%C2%9C'%1D%16..%C3%B7R%3C%0E%C2%AC%001%C3%B0%1AJlBfl%C2%B5%0D%02%7B%3A%C2%B6%C3%9E%C2%84%12%C2%9B%19%C3%87)%7D%C2%95PR%5B%7C%C2%9C%C3%92%C2%A7%C3%82%C3%A5gh%C3%B1%250%03%C2%9C%00%C3%97%C3%80%C2%95Nq%C3%95Pb%3B-%C2%AA%C3%B47%C3%AF%C3%B4%C3%97B%C2%89%3B%05%C2%90N%C2%89%3F%C2%988%C3%ADG%C3%A1%C2%AF%24%3E%C3%A2f%00q%C3%99G%C2%BC%5Bp%08%7D%02%C2%B6T%C3%81%C3%9D%C3%82%C2%A41%07%2C%C3%ABu%C2%9D%C3%B7%C2%9D%C2%AB8%C3%B1%0Cl%C2%AB%C2%A0%C3%94%C3%9A%C3%82%C3%B4%1C%C3%A0%1B%C3%82%C2%B0%07%C3%89%C2%B7_%0D%C3%B5%00%00%00%00IEND%C2%AEB%60%C2%82";
    var copy_img = group2.add("image", undefined, File.decode(copy_img_imgString), { name: "copy_img" });

    var mir_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%02dIDATH%C2%89%C3%95%C2%97_h%C2%8Fa%14%C3%87%3F~%C2%B3%C3%89%05a%1BB%C3%A2%C2%A7Q%C3%A2n.%C2%AC%C2%85%2BW.%14%C2%B7dQ%C2%BBXS%C2%94%C2%94%1B%7FR%237%C3%B2%C2%A7%C2%B6%C3%B2'%5C%C2%93%5CQ%C3%8A%C2%B4%0B%C3%85%0D%23%C3%86%18%C2%91V6%1B%C2%8A%C2%8Be%C2%8EN%3B%2FO%C2%AF%C3%9F%C3%BB%C3%BC%C2%9E%C3%B7%C3%B9%C2%B5%C2%B4So%C3%AF%C2%9F%C3%B3%C2%9C%3F%C3%9Fs%C2%9Es%C3%8E%C3%B3%C3%B2%C2%BFh%C2%9A%C2%88%C3%84%C2%98%C2%AE%07n%02%C3%BD%C3%80%C2%AE%18%05%C2%B1%C2%86W%00%C2%AF%13%1D1%0A%C2%A6%C3%87%08%01%1F%C2%80%26%C3%A0%7B%C2%A4%7C4%C3%A2%C2%8A%C2%A9%10%C2%A9%60%110%02%3C%C2%88u%40%0Do%01.%C3%A7%C2%94%C2%AB%02%C3%A6%02%C3%B3s%C3%8A%C2%A9%C3%83%17%C2%80fD%C2%A4G%26%C2%A8WD%C3%AA4%C3%B4%C2%93t5%C2%88%C3%88%C2%B0%C3%99%C3%AAT%C3%84_%C3%8C%C2%9B%C2%B5%C3%80%0B%60A%C2%80%C3%A7%C3%95%C3%80%1A%C2%A0%18%C2%88%C2%B4%11x%0A%C3%94%C3%9A%C3%BB%C3%97%C2%82%C2%93%C3%A7%C3%A7%40%1D%C3%90%07%C2%AC.%C2%A3h%C2%A9)z%13%60t%23%C3%B0%08%C2%98%C3%A1%7C%C3%BBUpJ%C2%AA%198%0C%C3%8C%01%1E%03%C3%AB%3C%C3%8A4J%C3%97%C2%81%C3%93e%C2%8Cn%05%C2%BAKrD%C3%A4%C2%B6%C3%85%7D%C2%B9%C3%A5%C3%B6%C2%94%C3%BC%C2%A5%C3%8D%15%C3%A4%C2%BBE%C2%B2%C2%A9%C3%83-%C2%A7%24%C2%B7%07%C2%80%C2%A3%C3%B6%7C%07%C3%98%5E%C3%82%C3%9FY%C3%80!%60O%06%C3%92%C3%BD%C3%80%25o%2C%1C%C3%84%C2%8D)%C2%8F%C3%9B%1C%7Fw%C2%A7x%0D%0E%2F%C2%8D%C3%B4%C2%B8%07iB%1D%C2%BE%C2%96y%1E%18%02%C2%BA%C2%AC%C3%B6t0%C2%9C0%C3%9E%20%C3%90%0E%0C%3B%C3%AB5z%17%C2%83%C2%87%C2%86%07qr%C3%B5%1A%C2%BF%C2%AFLN%C2%AB%02%C2%90%C3%BEA%C3%ACk%C2%99Z%C2%AB%0F%C2%AD%C2%BEu%C2%97%C2%AFwx%C2%8A%C3%BE%1Ep%C3%85%C3%B96%0E%C2%AC%02%3E%C2%87%00%C3%8E2%C2%AC%C2%85%C3%BE%C3%8CJ%C2%AA%C3%87%C3%AE%C2%A3%0E_7%C3%97%26%60gJ%C3%AE%C2%959%C3%BA6%C2%8F%C3%A1j%C2%BB%2F%C2%B3f%C2%B2%12%C2%B8%05l%00~%C2%A6%C3%A4%C3%9E%5B%C3%97ZRB%C3%A7%C2%A0%13%C2%A5lrr%C2%AC%C3%8F%C3%B5%22%C3%B2%C3%83%C3%9E%C2%AFU%C3%98%C2%B35%C3%A7%C3%B7Cr%C3%9Cf%C3%ADr%C2%A6u%C2%A4%1D%1E%7F%17%03c%C3%80%13%C3%8F%C2%9Aqk%C2%977%C2%B2B%3Df%C3%8F%C3%A7%C2%80y%C3%801%60%C2%9F7L%13%C3%87%1DMMM%C2%99uJ%C3%9B%C2%80%C2%AB%C3%BF%7C%15%C2%91n'%04%7B'q%2C%C2%9Et%C3%AC%C2%9C-%C3%98%C3%AEUj%01%C3%8E%04%20%C3%80%06K%C3%91B%1EJ%07%C2%AD%15k%0A%C3%9E%C3%A9%C2%99K%C3%83%C2%B6%C3%90vc(%15%C2%9D%C2%91%C2%98%C3%B7%C2%94%C2%A9%C2%A7%C2%96!%C3%B5%5Cr%1AU%C3%BA%06%C3%9C%05%06r%C3%8A)%7Db*%C2%9E2g%03G%C2%80%C3%96X%C3%83%C2%B1%C2%88%C2%B5%C2%AB%C2%BDLt%C3%84(%C2%88%C3%BD%C2%93%C3%90q%C2%A9%23%C3%B0c%C2%944%C3%B0%1B9Z%C2%BC%17%5C%C3%9A%3E%C2%B5%00%00%00%00IEND%C2%AEB%60%C2%82";
    var mir_img = group2.add("image", undefined, File.decode(mir_img_imgString), { name: "mir_img" });

    var int_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%02%40IDATH%C2%89%C3%A5%C2%96O%C2%88Mq%14%C3%87%3FO3%C2%93%3F%C2%AF(%13%0B%26%7F%C3%924La%23Ii%C2%A64%C2%89%C2%B2%18%0B%1Bj%10%3B%1B%C2%8B%C3%99%C2%8D%C2%B0PS%C2%96da!%C2%94%0DJ%C2%A1%C2%94%C3%A2%C2%AD%C2%942%C2%BC!%C2%92%7F%0B5%1A%C2%B1xe%C2%B2P%C3%A6%C2%AB%C3%9B%C2%9C%C3%BB%3A%C3%BD%C3%9C%C3%9Fu%C3%9FpW%C3%B3%C2%AD%C3%93%C3%B9%C2%BD%7B%C3%8F9%C2%9F%C3%B7%C3%BBu%C3%AF%C2%B9%C2%879%C2%A7J%C2%B2aI%7F%C3%9Bw'p%10X%08%5C%00%1A%C3%AE%5ER%C3%A3%18%C2%B0%14%C2%98%0A%C3%B2%16%01%13%C3%80U%7F%C2%B1R%C2%A9%C3%8C%2C%12p%C3%84%C3%9A%24%1D%C2%97%C3%B4%5D3%C3%BA%25iE%10%C3%9B)iJq%C2%8D%C2%85%C2%B5%C2%9B%C2%8A%40%C3%BB%1D0%C3%91uI%03%C2%91%C3%98%1D%C2%92%C3%8EJ%C2%AA%07%C3%B8%1F%C2%92%C3%96%C2%B7%02%3E%C3%A1%C2%92%C2%BFI%C3%9A%C2%9Es*%C2%A1%1D%0A%C3%A0%7B%C2%8B%C2%82%C3%B7%C2%B9%C2%A4%C2%87%C2%92%3AZ%C2%80%C2%A6%C2%B6J%C3%92cWg%C2%B0%08%C3%B8%C2%BD%05%C2%8F%C3%8F%02%18%C3%9A%C2%B8%C3%95%C2%9A%C2%944%3F%0F%3Cj%C2%81%1F%25-%C3%89(%C3%94%C2%97%C3%B3%10%C2%9D%C3%8A%C2%88%C2%AFJza%C3%B7%C2%AF%C3%84%C3%80%2B%5D%C2%91%C2%9E%C3%88%0E6K%C2%AA%C2%995%2C%C2%B6n%C2%BF%C2%87%229k%5D%C3%9DmY%C3%A0a%C2%BBy%C2%BE%C3%A01%C3%96%2C%C2%BE%C2%AF%40%C3%AC%C2%88%C3%85%5EL%C3%81%C3%B3%C2%8C%C2%BD%00%18%C2%B4%C3%B5%C3%AD%12%C2%BA%C3%A8%0D%C3%B3%07%C2%80%5E%0F%C3%9E%00l%C2%B5%C3%B5%C3%93%12%C3%80o%C2%80W%40%15%C3%A8%C3%B6%C3%A0.%17%C3%90%C2%88%C3%A7%C3%BF%C2%93%C3%AEY%C3%B2j%0F%C3%BEi%C3%BEmI%C3%90D%C3%8F%C3%8D%C2%B7%7Bp%C3%AA%3F%C2%95%08%C2%AE%C2%9A%C2%9F%C3%B6%C3%80v%C3%B3%C3%9D%25%C2%82%7B%C2%B3%C3%80%C3%A9N%07%C2%80%C3%85%25%C2%81%7B%C3%8C7%3Cx%0Cx%60%C3%ABM%25%40%C2%93%C3%AF%C3%B9.%5B%C2%BF%C3%B3%C3%A0Dw%C3%8C%C3%AF%2F%01%C3%9Co%C3%BE%09Po%5E%C2%B5%C3%AE%C3%92%C3%A5Z%C3%9B%C2%96H%07j%C2%B5W%C2%A7v%C3%9Fb%C2%8E%C2%A6%C2%9D%2B%1C%7D%C3%8E%00%23%C3%80W%60%230%19%C3%BC%C3%B3%C3%A4%1D%1C%C2%8A%C3%AC%C2%AAf%16%C3%AA%24p%1A%C3%B8%00%C2%AC%23g%C3%B4%C3%B9%C2%9F%C2%9F%C3%85aw%22%C3%8D%C3%A9%25%3C%C3%AA%C2%ACA%C3%A0%C2%91%C2%A4e%C2%B3%C2%84%C3%BAI%C3%A4R%C2%91A%20%C2%B1%23.iZ%C3%92%C2%9E%16%C2%A1%C3%A7%5C%C3%BE%1F'%C2%97%07%26%18%5D%12%C3%9D%C2%94tX%C3%92%C2%9AH%C3%BCrI%C2%BB%25%C2%BDv9%C3%97%C2%B2F%C2%A7%3C%C3%B0%C2%A8%C3%B2%C2%955m%3Es%19%2F%25%C3%AD%C2%8C%C2%9DH%C2%A2%C2%B6%C3%88%13Z%C2%B7o%C3%A8%C2%97%C3%A0z%C2%875%C2%83%C2%89%C2%8C%C2%9C%C2%BB%C3%80g%C3%A02p%2BRw%C2%AE%0A%C3%B8%0D%C3%91%C2%B38S%7B%3F%C3%B5%C2%84%00%00%00%00IEND%C2%AEB%60%C2%82";
    var int_img = group2.add("image", undefined, File.decode(int_img_imgString), { name: "int_img" });

    var move_left_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%18%00%00%00%1E%08%06%00%00%006.%C3%9E%C3%A5%00%00%00%C3%B2IDATH%C2%89%C3%AD%C3%94%3D%C2%8A%C3%82%40%18%C3%86%C3%B1%C3%81B%3C%C3%82%16~U%7B%C2%80EP%24%16%C2%8A%C2%87%C2%B0%C3%9A%C3%8E%1Bx%04%C2%B1Q%10%C3%84k%08%16%0A%C3%A2%07%1E%C3%85%C3%86%0BX%08%C2%AB%20%C3%BFeD%C3%B1Ave%C2%A2%C2%99B%C3%88%0B%0F%C2%84%04%C2%9E%C3%9F%C3%8C%24%C3%84%C3%84%13%C3%8Fy%00%C2%97%C3%94%C2%81%16%C2%90%0C%7Dj%0E%C3%A5en%C3%B3%1D5P%C2%95%C3%B2%13%C3%B0%15%25%C2%A0%C3%A5%3F%C3%80%C2%A7%C2%BD%1F%15P%C2%92%C3%B2%3D%C2%90%C2%B9%3E%C2%8B%02(%C3%9E%C2%95g%C3%B5%C3%B9%C2%AB%40%20%C3%A5%3B%C3%A0%C3%A3~%01%C2%AF%00%15)%3F%00%C2%B9%C2%BF%C2%8E%C3%AFY%C2%A0%26%C3%A5G%20%C3%BF%C3%9F%C3%8B%7F%06hH%C3%B9%06H%3F%C3%BAtu%12%C2%8EFA%C2%AE'%C3%86%C2%98m%C3%B8e%3E%C3%9EA%0AX%C3%89.z%C2%AE%3Bp%05%C2%AEY%0A2%C3%B0%01%C3%98%C3%8C%04i%C3%BB%00l%C2%A6%C2%82t%7C%006cA%C2%BA%3E%00%C2%9B%C2%B5%20%7D%1F%C2%80%C3%8DB%C2%90%C2%A1%0F%C3%80f.H%C3%93%07%603%C2%BA%C3%BCY%C2%83%C3%B0%5B%C2%88%C3%A7%7D%C3%87%18%C3%B3%0B(i%C3%A5%0CX%C3%B4%C2%96%C3%BE%00%00%00%00IEND%C2%AEB%60%C2%82";
    var move_left_img = group2.add("image", undefined, File.decode(move_left_img_imgString), { name: "move_left_img" });

    var move_right_img_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%18%00%00%00%1E%08%06%00%00%006.%C3%9E%C3%A5%00%00%00%C3%9DIDATH%C2%89%C3%AD%C2%95%3B%0A%C3%82%40%14E%1F%16%C3%A2%12%2C%C3%BCU.%40%04Eb%C2%A1%C2%B8%08%2B%3Bw%C3%A0%12%C3%84FA%C2%90lC%C2%B0P%10%3F%C2%B8%14%1B7%60!%C2%A8%20G%06%04%1F61%C3%A1%C2%A5%C3%91%5C%C2%B8E%C2%9Asf%C2%98%C2%99%17I%C3%B2%C2%87%01%C3%92%C3%80%00%C3%A8%00%12%C3%94%C3%90%01z%C2%BC%C3%93%C2%88CP%01%1EJ%C3%92%C2%B2%16%C2%B8%C2%96%C2%81%C3%AB7%C2%92%C2%A8%02%C3%97%3CpQ%C2%92%C2%BA%C2%B5%C3%80%C2%B5%C3%B0!%C2%A9Y%0B%5C%C2%B3%C3%80YI%3Ck%C2%81k%11%C2%B8)I%C3%93Z%C3%A0Z%02%C3%AEJ%C3%92%C2%B6%16%C2%B8%C3%A6%C2%80%C2%A3%C2%92t%C2%83x%C2%A9%C2%90%C3%BE%C2%93%C2%88%2C%C3%95w%C3%95z%07%13%C2%B5%C3%BA%3D%C2%90%C2%B1%14%C3%8C%14%7Cg%7D%C3%88C%05_%5B_%C3%93%C2%91%C2%82%C2%AF%C2%AC%1F%C3%9AX%C3%81%17%C3%96%C2%A3b%C2%AA%C3%A0%07%C3%ABa%C3%A7%2B%C3%B8%C3%96z%5C%C3%B7%15%7C%13%C3%87%0F%C3%87%7BM%C3%90y%10%3C%C2%92%20%C3%89%C2%8FED%C2%9E%C3%99%C3%9F%C3%A5%0C%C3%B71%C2%86%C2%B1%00%00%00%00IEND%C2%AEB%60%C2%82";
    var move_right_img = group2.add("image", undefined, File.decode(move_right_img_imgString), { name: "move_right_img" });


    copy_img.addEventListener("click", paste_key, false)
    mir_img.addEventListener("click", reverse_key, false)
    int_img.addEventListener("click", key_to_int, false)
    // align_left_img.addEventListener("click", aa, false)
    // align_right_img.addEventListener("click", bb, false)

    // GROUP3
    // ======
    var group3 = main.add("group", undefined, { name: "group3" });
    group3.orientation = "row";
    group3.alignChildren = ["left", "center"];
    group3.spacing = 10;
    group3.margins = 0;

    var image1_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%00%19tEXtSoftware%00Adobe%20ImageReadyq%C3%89e%3C%00%00%01%07IDATx%C3%9A%C3%AC%C2%96%C3%BD%0D%C2%83%20%10%C3%85%C3%85t%00Fp%04Gh7p%04%C2%BBA%3B%C2%89%23t%C2%85n%C2%A0%1B%C3%98%11%C2%BA%C2%81n%40%1F%0D%C2%B4h%3DA%22%C3%B8G%7D%C3%89%C2%8B%17%14%7F%7C%C3%9C%11%C2%98%C2%80%C2%92%0D%C2%94%26%1B%C3%A9%60%C3%84W%C3%B8%11%C2%98%C2%97%C3%83%C3%95%3B%12_%1D%5Dz%C3%A2%C2%BB%1C%C3%A6%3ET%C3%89%C3%90%C2%B0tA%C2%A7%02%C3%AE%10%C2%B6p%C2%87%C3%B8%C3%A6%3B%00%C3%A7%19%C3%A3%5D%26%C2%A1%C3%A2WU%C3%A8%19%170'%C3%9A7%C3%89j%1E%1A%7C_%C3%98%C2%BE%0E%C2%981%C3%B6%C3%84%C3%A3%0C%C3%B7Fs%C2%A3J0%5Cr%19%C3%9Fr%C2%95%20Y%C2%B4rR3%C3%AF%C3%A1F%C2%AD%C2%809%C2%98Z%C3%96w%C2%B4%C3%A4Ru%5C%C3%83r%C2%B5%16%C3%81S%C3%8B%C2%8F%2B%C2%B8%C2%B4%40s%23%C3%83%C3%9D%C3%A1%C3%94%1E%C2%AB%C2%93I%C2%AB%C2%9C%C3%98%C3%ABVL%C2%AB%C2%A3%C3%A0%C3%A6%1EO%C2%82G%C3%90%01%C3%9C%02%C2%9D%C2%85%C3%8F%C2%82%09%C2%A8%C3%96%C3%85%01J%C3%82I%C2%B0%05%C3%AA%C2%A3%01%C2%9C%02%C2%B7%22%C2%8C%3Ep%13%C3%8C%22%5D%7D%C3%A4%C2%89w%C3%92%C2%99%1F%C3%B3%C3%AA3.%C2%BD%C2%84%C3%BD%C3%9Deo%07%C3%AF%C3%A0%1D%C2%BC%C2%9A%5E%02%0C%00u%C2%82%C2%98%3D%C3%8A%C2%8D%C3%B4%C2%B0%00%00%00%00IEND%C2%AEB%60%C2%82";
    var image1 = group3.add("image", undefined, File.decode(image1_imgString), { name: "image1" });

    var image2 = group3.add("image", undefined, File.decode(image1_imgString), { name: "image2" });

    var image3_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%02%C2%8AIDATH%C2%89%C3%A5V%3DhTA%10%C3%BENb%40%0DD0%18!%06O%05%C2%B9%20%C2%A8%10%2CD%C2%88%17%C2%90C%14%24%C3%86B%10%0C%C2%A8hgca%19%C2%82%C2%85%10%C2%B0%C2%B0%C2%B1%C2%B20*%C3%98%C2%A8%C2%85%C2%A8%20%08z%C2%95h%11%C3%8D%C2%8FH%C3%90%23%C2%84%40%04%C3%85%22%C2%92%20%22%C2%98O%C3%96%C3%8C%C3%8Ad%7C%C2%BBo%2F%C3%98%C3%A5%C2%83%C2%B9y%C3%B7vf%C2%BE%C3%9Dy%C2%B3%C2%B3%C2%8B%15%C2%87%C2%82%5B0%C3%89%C2%BCu%C2%B7%008%05%60-%C2%80%C3%AB%00f%C3%95%C2%98%C2%8Bq%1E%C3%80%06%00%C3%B3%C3%86o%1D%C2%80%19%00%C2%B7%C3%B5%C3%8BB%C2%A1%C2%B0%C3%B8%C3%A0%C2%88%03%C3%92%40%C3%B2%02%C3%899.%C3%A2%17%C3%896c%C3%9BBr%C2%9Ea%0C%C3%9B%C3%98%7F%11%20%C3%ADV%C2%84%0EwIV%02%C2%B6%5D%24%C2%AF%C2%90%1C1%C3%B4%C3%9FIv%C3%94C%7CQ9%7F%25%C2%B9%3F%C2%92%15%2B%C2%A7%0D%C3%B9%C3%91T%C3%A2%C3%A3%C3%8A%C3%A99%C3%89%C3%86%3AH%C2%BDl!%C3%B9R%C3%85%C3%A9%C2%B5%C3%84Y%C3%85U%03%C2%B0%1D%C3%80%18%C2%80%C3%9D%C2%91%C2%82%1B%10%3D%05%60(%603%0A%60%17%C2%80%C3%8F%00%C2%8A%00~%C2%84%C2%8AkPf8Ir%7DdEE%C2%B5%C2%9A%C2%A9%C2%88%5D%13%C3%891%C2%B1%C2%BB%15J%C3%B5f%15%C2%AC%C2%94%C2%93%C3%8A%1EEJ%C2%99H%C3%88v%C2%9B%C2%8A%C2%BB%C3%8F%13%C2%AFRi9)%C3%9A%C3%AD%C3%93%C2%89H%C2%8A%1D%C3%8A%C2%A2%C2%AB%C2%A2%C3%B7Dl'%01%C3%B4%C3%8Bs%C3%9F%C2%92%11%C2%92kH%C2%BE%C2%92Y%1DL(%C2%9E%C2%AA%C3%98%C2%96E_%C3%8B%C2%B1%2F%C2%89%C2%9D%C3%9B%C2%9E%3B5q%C2%A7JG%C3%AC%C3%9Bz%C2%A1%C2%90%C3%9B%C3%A7%C2%98%C2%BC%13%C3%9Bc%3A%C3%95%C3%AD%C2%A2'L%3BLI%C2%B3%C2%AB%C3%9C%039%3E%0EOD%175%C3%B1O%C3%91%1F%12%02x%C3%A2%113%C2%81r%C3%80%C3%9E%C3%A3%C2%AD%C3%A8%C3%95%C2%9A%C3%98%C3%AB%C3%A9%04b_H%03B%C3%9A%C2%93H%C3%9C%24z%C3%81%C3%BD4%C3%A8Y%00%C3%98%C2%91%40%C3%AC%09ls%C2%89U%C2%B6%C2%83%2F%C2%AA%3F%C3%84v%C2%A5%15%00%C3%8D%11%C3%A7%C2%A2%C2%8C%3F%C2%94%C2%AE%C3%A7%C3%A5%5B%C3%82%C2%8AK%C2%A2g5%C3%B10%C2%80g%C2%81%C2%95h%C3%98%C3%AF%0B%C3%B5%C2%BF%C3%99%17N%06%C3%9Cy~H%5E%7F%C2%84i%20%C2%8FD%C2%9FH%20%C2%AE%C2%9A%C3%B7y%05%C3%96-%C3%BA%C3%B5%C2%92I%C3%8B%C3%9EkW%7ByoN%C3%A3%C2%B0%7B%C3%9D%C2%B7%C3%90%C2%A1%C2%80%C3%9FS%19%3F%17%3A%16%2F%C2%8B%C3%81%17%C2%92%C2%9B%C2%96q%1CfI%C2%BF%C3%84%C2%AC%C3%A5%C2%9D%C3%8751%1C%C3%BD%0F%C2%A4%C2%97T%16%2By%C3%84%C3%BA%22%C3%B0%C2%82%C3%A4%C3%86e%C2%92%C3%AA%C2%9B%C3%88%0D%3D%16%22vrV9-%C2%90%3CR'%C3%A9U%C3%A5%C3%BFO%C3%A6b%C3%840W%17%C2%87%C3%BB%24%C3%8F%C2%90%C3%9C%1A%C2%B0o%25y%C2%98%C3%A4%7B%C3%A5s'%C3%AB%C3%AA%14%23%1Ed%1CY%C2%B7%C3%8D7%C3%8Ac%3Cv%C2%BCB%C2%B5L%0B%C2%B7%C3%97%C3%AE%C3%89%5DI%C2%A3Q%C2%9A%C3%81L%C2%86%C3%8Fc%00%C2%9F%00%C3%9C%04%C3%B0%20%10w%C2%A5%02%C3%80o4%C2%9B%C2%98o%01%05%C3%BD%C3%95%00%00%00%00IEND%C2%AEB%60%C2%82";
    var image3 = group3.add("image", undefined, File.decode(image3_imgString), { name: "image3" });

    var image4_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%18%00%00%00%1E%08%06%00%00%006.%C3%9E%C3%A5%00%00%00%C3%B5IDATH%C2%89%C3%AD%C2%96%3D%0A%C3%82%40%10%C2%85_%C2%92BDE%3C%C2%8A%C2%8D%C2%AD%C3%B7%10%2C-%C2%BC%C2%82%C2%85%C2%95G%C2%B2P%10%0B-%3C%C2%80%08%C2%82XXhmg%C3%A7%C2%93%05%C2%83%C3%ABfb%24%3B%01%C2%85%0CL1%C2%BB%C3%89%7C%C3%B3%C2%B3%C3%AC%2C~BH%C2%A6i%40%C3%B2%C3%8C%C2%97L%C3%9DxC%C3%8F%04%02%00%0D%C3%8B%C2%AEi%03%C3%B8T%C3%9BV%05dJ%09(%1C%60%C2%9Az%2F%12%C3%90r%C2%8E%C2%A9%3A%60%06%20%C2%B2%C3%AC%40%13%C2%B0%02%C3%90q%C3%96%C3%A6%C2%B9%3C%09%C3%97%C3%84%C2%9AI%19%C2%9B%3D%0D%C3%80Fp%3E%C2%8A%C3%B7%7D%01%0B%C3%81%C3%B9%C3%84%0E%20%2F%C2%A0M%C3%B2%248%C3%AF%C2%B9%C3%A5s%C3%A5%C3%9B%26%C3%97%014%C2%85%C3%B5k%C2%BE%C2%90%C2%93%19%18%C2%8DHn%C2%85%2C%C2%86%1A%25%C2%8A%C2%B5J%C3%B2(%40%C3%BAZ%00%C2%A3%15%C2%92%C3%BB%C2%B4L4%00FC%C2%92%3B%012%C3%90%02%C3%84%C3%A5%3A8%C2%80%C2%A5%C3%BB%C2%AF%C3%8FUq%03%C3%90%C3%8D%C3%BA%C3%88%C3%B7%C2%B2%C2%BBd%1DU%C2%8DW%C3%85G%1F%C3%A5L%C3%BE%7F%C2%80i%C2%B2%3D%26%C3%9FG%26%C2%80%074%C2%B3%C2%86%C3%B2%C2%B4%05%C2%8D%C2%BC%00%00%00%00IEND%C2%AEB%60%C2%82";
    var image4 = group3.add("image", undefined, File.decode(image4_imgString), { name: "image4" });

    var image5_imgString = "%C2%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%1E%00%00%00%1E%08%06%00%00%00%3B0%C2%AE%C2%A2%00%00%01%05IDATH%C2%89%C3%AD%C3%96%3Fk%021%18%C3%87%C3%B1%C3%87%C3%9Av%C3%B0%C3%9F%C3%A0%C3%947%C3%A1%C3%9C%C3%8D%C3%99%C2%B7%C3%A0%2Br%13%C2%BA9%C2%BA%C3%99%C3%99%5B%0A%C3%92%C3%89%C2%B1C%0B%C2%85n%C2%82%C3%A0%C3%A4T%C2%A8%C3%94%C3%8D~%C3%A5hJ!%3E%C3%A5.%C3%A6%12%2B%C3%9C%0F%1E%1Er%C2%90%7C%C3%88%1D%09'y%03%0C%C3%B8%C3%8E%C2%87%C3%A9%23%40%C3%BE%C2%AA%C2%AC%5C%C3%A4%C2%96E%C3%AA%C2%A67M%C2%AF9%C3%8C%3D%C2%88%0B%C2%BC%C2%B3%C3%86_%C2%B1%C3%A0BS%C3%82g%01g%C2%9F%C2%99%40%C3%B0M%2C%C3%B8%C3%8A%1A%C3%B7Dd%C3%A8%C2%83%C3%A7%0A%C3%90%056%1CF%C2%BD%C3%81%C2%8A%C2%84%C3%93j%03%2B%05%C2%BF%0F%0D%C2%A7u%0D%C2%BC)x%12%1A%C3%BE%C2%A9'%05%C2%9F%C3%85%C2%80%C3%93%1A%2B%C3%B8%1A%C2%B8%C3%8DZ%C3%8F%C3%B7%02yW%C2%9E%C2%B5D%C2%A4%C3%A1%C2%B9%C3%AEo%C2%94%C3%9D%26%C3%8An_%C2%81J%C3%88W%C3%BD%C2%A0%C2%A0%C3%8F%C3%80e%C2%A8o%5C%05%5E%14%C3%B41%C3%A4q%C3%AA%00K%05%C2%9D%C2%86%C2%BE%40%C3%AE%14t%12%C3%A3%C2%9F%C3%8B%5Em.%22%7D%C3%A7%1D%14%00%2F%C2%8EE%5Da%3B%C2%95S%C3%81%5E)%C3%A1%7F%09W%3D%C3%A6z%C3%81%C2%9F%C2%A6oL%C3%9F%1E%C2%AD%C2%8A%C3%88%1EQ%C3%93%C3%92X%0B%C3%B74%C3%BE%00%00%00%00IEND%C2%AEB%60%C2%82";
    var image5 = group3.add("image", undefined, File.decode(image5_imgString), { name: "image5" });

    image1.addEventListener("click", space_in, false)
    image2.addEventListener("click", space_out, false)
    image3.addEventListener("click", space_all, false)
    // image1.addEventListener("click", aa, false)
    // image1.addEventListener("click", bb, false)


    // Global
    var time_list
    var props_key_info
    var min_time


    function get_time_list() {

        app.beginUndoGroup("Get Time");
        time_list = false
        var comp = app.project.activeItem;  // 激活的合成

        if (!comp) return
        if (ScriptUI.environment.keyboardState.shiftKey === true) {
            time_list = []
            time_temp = prompt("时间列表：可以用逗号、空格分割数字", "1,2,3", "输入时间列表").replace(";", ",").replace(" ", ",").split(",")
            for (var i = 0; i < time_temp.length; i++) {
                var v = parseFloat(time_temp[i])
                if (v.toString() != "NaN") {
                    time_list.push(v)
                }
            }
            if (time_list.length > 0) {
                return time_list
            } else {
                time_list = false
                alert("请输入正确的时间格式")
            }
        } else if (ScriptUI.environment.keyboardState.ctrlKey === true) {
            copy_key()
        } else {
            var selLayers = app.project.activeItem.selectedLayers  // 当前合成的图层选择列表
            // 检测的同时进行赋值
            if (prop = check_sel_key(comp)) {
                time_list = get_sel_key_time(prop)
            } else {
                if (selLayers[0] === undefined) {
                    time_list = get_comp_marker_time(comp)
                } else {
                    time_list = get_layer_marker_time(selLayers[0])
                }
            }

            if (time_list) {
                // 复制到剪切板
                copyToClipboard(time_list)
                return time_list
            } else {
                alert("请至少选择一个一个属性的关键帧或者带有标记的图层或合成")
            }
        }
        app.endUndoGroup();
    }

    function creat_key() {
        app.beginUndoGroup("Creat Key");

        if (ScriptUI.environment.keyboardState.ctrlKey === true) {
            paste_key_ignore_err()
        } else {
            if (time_list) {
                var comp = app.project.activeItem;  // 激活的合成
                var selLayers = app.project.activeItem.selectedLayers  // 当前合成的图层选择列表
                var props = false
                if (!comp) return

                if (props = get_sel_props(comp)) {
                    for (var i = 0; i < props.length; i++) {
                        for (j = 0; j < time_list.length; j++)
                            props[i].addKey(time_list[j]);
                    }
                } else {
                    if (selLayers[0] === undefined) {
                        set_comp_marker_time(comp, time_list)
                    } else {
                        for (var i = 0; i < selLayers.length; i++) {
                            set_layer_marker_time(selLayers[i], time_list)
                        }
                    }
                }
            } else {
                alert("请先获取时间列表")
            }
        }
        app.endUndoGroup();
    }

    function exp_to_key() {
        app.beginUndoGroup("Expression To Keyframe");

        var comp = app.project.activeItem;  // 激活的合成
        var in_time = 0
        var out_time = 5
        var props

        if (!comp) return

        // shift 键 可以选择工作区
        if (ScriptUI.environment.keyboardState.shiftKey === true) {
            in_time = comp.workAreaStart
            out_time = comp.workAreaStart + comp.workAreaDuration
        }

        if (props = get_sel_props(comp)) {
            for (var i = 0; i < props.length; i++) {
                if (!ScriptUI.environment.keyboardState.shiftKey === true) {

                    var layer = props[i].propertyGroup(props[i].propertyDepth);
                    in_time = layer.inPoint
                    out_time = layer.outPoint
                }

                var time_and_value = get_key_value_by_time(comp, props[i], in_time, out_time)
                var time_list = time_and_value[0]
                var value_list = time_and_value[1]
                props[i].setValuesAtTimes(time_list, value_list)
                props[i].expressionEnabled = false
            }
        } else {
            alert("请选择要应用表达式转换的属性")
        }
        app.endUndoGroup();
    }
    function move_to_left() {

    }

    function move_to_right() {

    }


    function copy_key() {
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        min_time = 999999
        props_key_info = []

        if (!comp) return


        if (props = get_sel_props(comp)) {
            for (var i = 0; i < props.length; i++) {
                var key_info = []
                var prop = props[i]
                if (prop.keyTime(prop.selectedKeys[0]) < min_time) {
                    min_time = prop.keyTime(prop.selectedKeys[0])
                }
                var key_index_list = prop.selectedKeys
                for (var j = 0; j < key_index_list.length; j++) {
                    key_info.push(save_key_info(prop, key_index_list[j]))
                }

                props_key_info.push(key_info)
            }
        } else {
            alert("请至少选择一个属性")
        }
    }

    function remove_sel_key(props_key_info) {
        for (var i = 0; i < props_key_info.length; i++) {
            key_info = props_key_info[i]
            for (var j = key_info.length - 1; j >= 0; j--) {
                var prop = key_info[j]["prop"]
                var index = key_info[j]["index"]
                prop.removeKey(index)
            }
        }
    }



    function paste_key() {
        copy_key()
        app.beginUndoGroup("paste_key");
        var comp = app.project.activeItem;  // 激活的合成

        var props = false
        if (!comp) return

        if (props = get_sel_props(comp)) {
            if (props.length != props_key_info.length) {
                alert("保存属性值与目标值数量不匹配")
                return
            }

            // remove_sel_key(props_key_info)

            for (var i = 0; i < props_key_info.length; i++) {

                var prop_key_list = props_key_info[i]

                for (var j = 0; j < prop_key_list.length; j++) {
                    var key_info = prop_key_list[j]
                    var new_time = comp.time - min_time + key_info["time"]
                    create_new_key(key_info, props[i], new_time)
                }
            }
        }

        app.endUndoGroup();
    }

    function paste_key_ignore_err() {
        app.beginUndoGroup("paste_key");
        var comp = app.project.activeItem;  // 激活的合成

        var props = false
        if (!comp) return

        if (props = get_sel_props(comp)) {
            if (props.length != props_key_info.length) {
                alert("保存属性值与目标值数量不匹配")
                return
            }

            // remove_sel_key(props_key_info)

            for (var i = 0; i < props_key_info.length; i++) {

                var prop_key_list = props_key_info[i]

                for (var j = 0; j < prop_key_list.length; j++) {
                    var key_info = prop_key_list[j]
                    var new_time = comp.time - min_time + key_info["time"]
                    create_new_key_ignore_err(key_info, props[i], new_time)
                }
            }
        }

        app.endUndoGroup();
    }

    function reverse_key() {

        app.beginUndoGroup("reverse_key");
        copy_key()
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        if (!comp) return

        if (props = get_sel_props(comp)) {
            if (props.length != props_key_info.length) {
                alert("保存属性值与目标值数量不匹配")
                return
            }

            // remove_sel_key(props_key_info)

            for (var i = 0; i < props_key_info.length; i++) {

                var prop_key_list = props_key_info[i]

                for (var j = prop_key_list.length - 1; j >= 0; j--) {
                    var key_info = prop_key_list[j]

                    var new_time = prop_key_list[j]["time"]

                    create_new_key(key_info, props[i], comp.time * 2 - new_time)
                }
            }
        }

        app.endUndoGroup();
    }

    function key_to_int() {
        copy_key()
        app.beginUndoGroup("csee");
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        if (!comp) return

        if (props = get_sel_props(comp)) {
            if (props.length != props_key_info.length) {
                alert("保存属性值与目标值数量不匹配")
                return
            }

            remove_sel_key(props_key_info)

            for (var i = 0; i < props_key_info.length; i++) {

                var prop_key_list = props_key_info[i]

                for (var j = 0; j < prop_key_list.length; j++) {
                    var key_info = prop_key_list[j]

                    var new_time = get_key_int_index_time(comp, key_info["time"])
                    create_new_key(key_info, props[i], new_time)
                }
            }
        }

        app.endUndoGroup();

    }


    function space_in() {
        app.beginUndoGroup("space_in");
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        if (!comp) return

        if (props = get_sel_space_props(comp)) {
            for (var i = 0; i < props.length; i++) {
                var prop = props[i]
                var keys = prop.selectedKeys
                for (var j = 0; j < keys.length; j++) {
                    var id = keys[j]
                    if (prop.PropertyValueType === PropertyValueType.TwoD_SPATIAL) {
                        prop.setSpatialTangentsAtKey(id, prop.keyInSpatialTangent(id), [0, 0])
                    } else if (prop.propertyValueType === PropertyValueType.ThreeD_SPATIAL) {
                        prop.setSpatialTangentsAtKey(id, prop.keyInSpatialTangent(id), [0, 0, 0])
                    }
                }
            }
        }
    }
    function space_out() {
        app.beginUndoGroup("space_out");
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        if (!comp) return

        if (props = get_sel_space_props(comp)) {
            for (var i = 0; i < props.length; i++) {
                var prop = props[i]
                var keys = prop.selectedKeys
                for (var j = 0; j < keys.length; j++) {
                    var id = keys[j]
                    if (prop.PropertyValueType === PropertyValueType.TwoD_SPATIAL) {
                        prop.setSpatialTangentsAtKey(id, [0, 0], prop.keyOutSpatialTangent(id))
                    } else if (prop.propertyValueType === PropertyValueType.ThreeD_SPATIAL) {
                        prop.setSpatialTangentsAtKey(id, [0, 0, 0], prop.keyOutSpatialTangent(id))
                    }
                }
            }
        }
    }
    function space_all() {

        app.beginUndoGroup("space_all");
        var comp = app.project.activeItem;  // 激活的合成
        var props = false
        if (!comp) return




        if (props = get_sel_space_props(comp)) {
            for (var i = 0; i < props.length; i++) {
                var prop = props[i]
                var keys = prop.selectedKeys
                for (var j = 0; j < keys.length; j++) {
                    var id = keys[j]
                    if (ScriptUI.environment.keyboardState.shiftKey !== true) {
                        if (prop.PropertyValueType === PropertyValueType.TwoD_SPATIAL) {
                            prop.setSpatialTangentsAtKey(id, [0, 0])
                        } else if (prop.propertyValueType === PropertyValueType.ThreeD_SPATIAL) {
                            prop.setSpatialTangentsAtKey(id, [0, 0, 0])
                        }
                    } else {
                        prop.setSpatialAutoBezierAtKey(id, true)
                    }

                }
            }
        }
    }


    function check_sel_key(comp) {
        var sel_props = comp.selectedProperties
        var prop = false
        if (sel_props.length > 0) {
            for (var i = 0; i < sel_props.length; i++) {
                if (sel_props[i].propertyType == PropertyType.PROPERTY && sel_props[i].selectedKeys.length > 0) {
                    prop = sel_props[i]
                    break
                }
            }
        }
        return prop
    }

    function get_key_value_by_time(comp, prop, in_time, out_time) {
        var time_list = []
        var key_value = []
        var fd = comp.frameDuration
        for (var i = in_time; i <= out_time; i += fd) {
            time_list.push(i)
            key_value.push(prop.valueAtTime(i, true))
        }
        return [time_list, key_value]
    }

    function get_key_int_index_time(comp, input_time) {
        var fd = comp.frameDuration
        var md = input_time % fd // 取余

        if (md == 0) {
            return input_time
        } else if (md < fd / 2) {
            return input_time - md
        } else {
            return input_time + fd - md
        }
    }

    function get_sel_props(comp) {
        var sel_props = comp.selectedProperties
        var prop_list = []
        if (sel_props.length > 0) {
            for (var i = 0; i < sel_props.length; i++) {
                if (sel_props[i].propertyType == PropertyType.PROPERTY) {
                    prop_list.push(sel_props[i])
                }
            }
        }
        if (prop_list.length > 0) {
            return prop_list
        } else {
            return false
        }
    }


    function get_sel_space_props(comp) {
        var sel_props = comp.selectedProperties
        var prop_list = []
        if (sel_props.length > 0) {
            for (var i = 0; i < sel_props.length; i++) {
                if (sel_props[i].propertyType == PropertyType.PROPERTY && sel_props[i].isSpatial) {
                    prop_list.push(sel_props[i])
                }
            }
        }
        if (prop_list.length > 0) {
            return prop_list
        } else {
            return false
        }
    }


    function set_layer_marker_time(layer, marker_time) {
        var layer_mark = layer.property("Marker")
        for (var i = 0; i < marker_time.length; i++) {
            var layerMarker = new MarkerValue(i + 1);
            layer_mark.setValueAtTime(marker_time[i], layerMarker)
        }
    }


    function get_sel_key_time(prop) {
        var key_time = []

        for (var i = 1; i <= prop.selectedKeys.length; i++) {
            key_time.push(prop.keyTime(i))
        }
        return key_time
    }

    function get_layer_marker_time(layer) {
        var marker_time = []
        var layer_mark = layer.property("Marker")

        if (layer_mark.numKeys > 0) {
            for (var i = 1; i <= layer_mark.numKeys; i++) {
                marker_time.push(layer_mark.keyTime(i))
            }
            return marker_time
        } else {
            return false
        }
    }

    function get_comp_marker_time(comp) {
        var marker_time = []
        var comp_mark = comp.markerProperty
        if (comp_mark.numKeys > 0) {
            for (var i = 1; i <= comp_mark.numKeys; i++) {
                marker_time.push(comp_mark.keyTime(i))
            }
            return marker_time
        } else {
            return false
        }
    }

    function set_comp_marker_time(comp, marker_time) {
        var comp_mark = comp.markerProperty
        for (var i = 0; i < marker_time.length; i++) {
            var compMarker = new MarkerValue(i + 1);
            comp_mark.setValueAtTime(marker_time[i], compMarker)
        }
    }


    function set_layer_marker_time(layer, marker_time) {
        var layer_mark = layer.property("Marker")
        for (var i = 0; i < marker_time.length; i++) {
            var layerMarker = new MarkerValue(i + 1);
            layer_mark.setValueAtTime(marker_time[i], layerMarker)
        }
    }



    function save_key_info(prop, key_index) {

        var inInterp = prop.keyInInterpolationType(key_index);    // 入点插值类型(线性、贝塞尔、定格)
        var outInterp = prop.keyOutInterpolationType(key_index);  //出点插值类型(线性、贝塞尔、定格)

        key_info = {
            "prop": prop,  // 关键帧所在属性
            "index": key_index,  // 关键帧索引
            "time": prop.keyTime(key_index), // 关键帧时间
            "value": prop.keyValue(key_index), // 关键帧值
            "inInterp": inInterp,
            "outInterp": outInterp,
            "both_bezier": (inInterp === KeyframeInterpolationType.BEZIER) && (outInterp === KeyframeInterpolationType.BEZIER), // 判断入点/出点贝塞尔  如果都是的话 先存一下
            "key_hold": outInterp !== KeyframeInterpolationType.HOLD,  // 判断出点是不是 非定格
            "key_space": (prop.propertyValueType === PropertyValueType.TwoD_SPATIAL) || (prop.propertyValueType === PropertyValueType.ThreeD_SPATIAL),  // 判断是不是空间值
        }

        if (prop.PropertyValueType == PropertyValueType.ThreeD_SPATIAL) {
            key_info["3d"] = true
        }
        if (prop.propertyValueType === PropertyValueType.TwoD_SPATIAL) {
            key_info["2d"] = true
        }
        // 判断入点/出点贝塞尔  如果是的话 先存一下
        if ((key_info["both_bezier"])) {
            key_info["tempAutoBezier"] = prop.keyTemporalAutoBezier(key_index); // 时间自动贝塞尔 → 布尔
            key_info["tempContBezier"] = prop.keyTemporalContinuous(key_index); // 时间连续性 → 布尔
        }

        // 判断出点是不是 非定格
        if ((key_info["key_hold"])) {
            key_info["inTempEase"] = prop.keyInTemporalEase(key_index);  // 入点关键帧缓入（1/2/3个对象）
            key_info["outTempEase"] = prop.keyOutTemporalEase(key_index);  // 出点关键帧缓入（1/2/3个对象）
        }

        // 2D空间值 与 3D空间值：锚点、位置之类
        if ((key_info["key_space"])) {
            key_info["spatAutoBezier"] = prop.keySpatialAutoBezier(key_index);  // 空间自动贝塞尔 → 布尔
            key_info["spatContBezier"] = prop.keySpatialContinuous(key_index); // 空间连续性 → 布尔

            key_info["inSpatTangent"] = prop.keyInSpatialTangent(key_index);  // 入点空间线性 → 浮点值数组(2/3)
            key_info["outSpatTangent"] = prop.keyOutSpatialTangent(key_index); // 出点空间线性 → 浮点值数组(2/3)
            key_info["roving"] = prop.keyRoving(key_index);
        }
        return key_info

    }



    function create_new_key(key_info, prop, newTime) {

        // var prop = key_info["prop"]
        var newKeyIndex = prop.addKey(newTime);
        prop.setValueAtKey(newKeyIndex, key_info.value);  // 设置关键帧的值


        // 不是定格关键帧
        if ((key_info["key_hold"])) {
            prop.setTemporalEaseAtKey(newKeyIndex, key_info["inTempEase"], key_info["outTempEase"]);  // 设置指定关键帧的入点出点时间缓动
        }
        prop.setInterpolationTypeAtKey(newKeyIndex, key_info["inInterp"], key_info["outInterp"]);  // 设置入点出点插值类型

        if ((key_info["both_bezier"]) && key_info["tempContBezier"]) {
            prop.setTemporalContinuousAtKey(newKeyIndex, tempContBezier);  // 设置时间连续性
            prop.setTemporalAutoBezierAtKey(newKeyIndex, tempAutoBezier);  // 设置时间自动贝塞尔
        }

        if (key_info["key_space"]) {
            prop.setSpatialContinuousAtKey(newKeyIndex, key_info["spatContBezier"]);  // 设置空间连续性
            prop.setSpatialAutoBezierAtKey(newKeyIndex, key_info["spatAutoBezier"]);  // 设置空间自动贝塞尔

            prop.setSpatialTangentsAtKey(newKeyIndex, key_info["inSpatTangent"], key_info["outSpatTangent"]);  // 设置入点出点切线向量
            prop.setRovingAtKey(newKeyIndex, key_info["roving"]);  // 设置关键帧漂浮
        }
    }

    function create_new_key_ignore_err(key_info, prop, newTime) {

        // var prop = key_info["prop"]
        var newKeyIndex = prop.addKey(newTime);

        try {
            prop.setValueAtKey(newKeyIndex, key_info.value);  // 设置关键帧的值
        } catch (err) {

        }

        // 不是定格关键帧
        if ((key_info["key_hold"])) {
            try {
                prop.setTemporalEaseAtKey(newKeyIndex, key_info["inTempEase"], key_info["outTempEase"]);  // 设置指定关键帧的入点出点时间缓动
            } catch (err) {
            }
        }
        prop.setInterpolationTypeAtKey(newKeyIndex, key_info["inInterp"], key_info["outInterp"]);  // 设置入点出点插值类型

        if ((key_info["both_bezier"]) && key_info["tempContBezier"]) {
            try {
                prop.setTemporalContinuousAtKey(newKeyIndex, tempContBezier);  // 设置时间连续性
                prop.setTemporalAutoBezierAtKey(newKeyIndex, tempAutoBezier);  // 设置时间自动贝塞尔

            } catch (err) {

            }
        }

        if (key_info["key_space"]) {
            try {
                prop.setSpatialContinuousAtKey(newKeyIndex, key_info["spatContBezier"]);  // 设置空间连续性
                prop.setSpatialAutoBezierAtKey(newKeyIndex, key_info["spatAutoBezier"]);  // 设置空间自动贝塞尔

                prop.setSpatialTangentsAtKey(newKeyIndex, key_info["inSpatTangent"], key_info["outSpatTangent"]);  // 设置入点出点切线向量
                prop.setRovingAtKey(newKeyIndex, key_info["roving"]);  // 设置关键帧漂浮
            } catch (err) {
            }
        }
    }


    function create_new_rev_key(key_info, prop, newTime) {

        // var prop = key_info["prop"]
        var newKeyIndex = prop.addKey(newTime);
        prop.setValueAtKey(newKeyIndex, key_info.value);  // 设置关键帧的值


        // 不是定格关键帧
        if ((key_info["key_hold"])) {
            prop.setTemporalEaseAtKey(newKeyIndex, key_info["outTempEase"], key_info["inTempEase"]);  // 设置指定关键帧的入点出点时间缓动
        }
        prop.setInterpolationTypeAtKey(newKeyIndex, key_info["outInterp"], key_info["inInterp"]);  // 设置入点出点插值类型

        if ((key_info["both_bezier"]) && key_info["tempContBezier"]) {
            prop.setTemporalContinuousAtKey(newKeyIndex, tempContBezier);  // 设置时间连续性
            prop.setTemporalAutoBezierAtKey(newKeyIndex, tempAutoBezier);  // 设置时间自动贝塞尔
        }

        if (key_info["key_space"]) {
            prop.setSpatialContinuousAtKey(newKeyIndex, key_info["spatContBezier"]);  // 设置空间连续性
            prop.setSpatialAutoBezierAtKey(newKeyIndex, key_info["spatAutoBezier"]);  // 设置空间自动贝塞尔

            prop.setSpatialTangentsAtKey(newKeyIndex, key_info["outSpatTangent"], key_info["inSpatTangent"]);  // 设置入点出点切线向量
            prop.setRovingAtKey(newKeyIndex, key_info["roving"]);  // 设置关键帧漂浮
        }
    }


    function copyToClipboard(string) {
        var cmd, isWindows;
        // 判断是不是字符串
        string = (typeof string === 'string') ? string : string.toString();
        isWindows = $.os.indexOf('Windows') !== -1;

        //OS的命令
        cmd = 'echo "' + string + '" | pbcopy';
        //windows的cmd命令
        if (isWindows) {
            cmd = 'cmd.exe /c cmd.exe /c "echo ' + string + ' | clip"';
        }

        system.callSystem(cmd);
    }













    main.layout.layout(true);
    main.layout.resize();
    main.onResizing = main.onResize = function () { this.layout.resize(); }

    if (main instanceof Window) main.show();

    return main;

}());